(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-779561a8"],{"1c31":function(t,e,a){"use strict";a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return i})),a.d(e,"d",(function(){return r})),a.d(e,"b",(function(){return o}));var n=a("b775"),s=(a("4328"),a("365c"));function l(t){return Object(n["a"])({url:""+s["a"].report.secGlobal,method:"get"})}function i(t){return Object(n["a"])({url:""+s["a"].report.secTrendx,method:"get",params:t})}function r(t){return Object(n["a"])({url:""+s["a"].report.secWafLog,method:"get",params:t})}function o(){return Object(n["a"])({url:""+s["a"].report.secOwasp,method:"get"})}},"7ce2":function(t,e,a){},a65c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("el-row",{staticClass:"dashboard",staticStyle:{background:"#fff",padding:"0 50px"},attrs:{gutter:10}},[e("el-col",{attrs:{span:24}},[e("div",{staticStyle:{"line-height":"50px","margin-top":"20px","padding-left":"10px"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},model:{value:t.searchContent,callback:function(e){t.searchContent=e},expression:"searchContent"}})],1)]),e("div",{staticStyle:{"line-height":"50px","margin-bottom":"20px","padding-left":"10px"}},[t._v(" 服务器选择： "),e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.onSelect},model:{value:t.host,callback:function(e){t.host=e},expression:"host"}},t._l(t.hostSelect,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("label",{staticStyle:{"margin-left":"20px"}},[t._v("日志条数")]),t._v("   "),e("el-input",{staticStyle:{width:"80px"},attrs:{placeholder:"最大值20000"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("span",{staticStyle:{"margin-left":"20px"},attrs:{required:!0}},[e("span",{staticStyle:{color:"red"}},[t._v("* ")]),t._v("最多查询20W条")]),t._v("   "),e("el-input",{staticStyle:{width:"180px","margin-left":"20px","margin-right":"20px"},attrs:{placeholder:"后端包含搜索"},model:{value:t.searchContentAsync,callback:function(e){t.searchContentAsync=e},expression:"searchContentAsync"}}),e("el-button",{attrs:{type:"primary"},on:{click:t.onSelect}},[t._v("查询")])],1),e("el-col",{staticStyle:{"margin-top":"-20px"},attrs:{span:24}},[e("el-table",{staticStyle:{},attrs:{data:t.results}},[e("el-table-column",{attrs:{label:"",prop:"content"}})],1)],1),e("el-col",{attrs:{span:24}},[e("WafPage",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{pageSizes:t.pageSizes,pageSize:t.pageSize,pageTotal:t.pageTotal,currentPage:t.currentPage},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}})],1)],1)],1)},s=[],l=(a("14d9"),a("164e"),a("1c31"));function i(t){for(var e=[],a=0,n=t.length;a<n;a++){var s=t[a];-1===e.indexOf(s)&&e.push(s)}return e}function r(t){var e,a=[],n=[];t.sort();for(var s=0;s<t.length;s++)t[s]!==e?(a.push(t[s]),n.push(1)):n[n.length-1]++,e=t[s];return[a,n]}const o=()=>a.e("chunk-cbab92e2").then(a.bind(null,"8af7")),h=()=>a.e("chunk-2d22c16d").then(a.bind(null,"f26a"));var c={data(){return{num:100,wafLogResult:[],wafDenyCount:"",wafAttackIP:"",wafAttackIPCount:"",gl_method:[],gl_method_title:[],option:{title:{text:"web攻击类型统计",x:"left"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"right",data:[]},series:[{name:"攻击类型",type:"pie",radius:"80%",center:["50%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},results:[],pageTable:[],pageSizes:[50],pageSize:50,pageTotal:0,currentPage:1,hostArr:[],hostObj:{},host:"",hostSelect:[],searchType:"url",content_select:[{label:"攻击类型",value:"attack_type"},{label:"攻击IP",value:"attack_ip"},{label:"攻击时间",value:"attack_time"},{label:"防护主机",value:"host"},{label:"协议类型",value:"scheme"},{label:"请求方法",value:"method"},{label:"攻击者浏览器",value:"user_agent"},{label:"访问URL",value:"url"},{label:"拦截位置",value:"position"},{label:"拦截设置",value:"deny_func"}],searchContent:"",tempContent:[],searchContentAsync:""}},mounted(){this.drawPie(this.host)},methods:{handleSizeChange(t){this.currentPage=1,this.pageSize=t,this.results=this.pageTable.slice(0,0+t)},handleCurrentChange(t){1===this.pageSize?this.results=this.pageTable.slice(0,t*this.pageSize):this.results=this.pageTable.slice(t*this.pageSize-this.pageSize,t*this.pageSize)},onSelect(){this.drawPie(this.host)},drawPie(t){var e={num:this.num,format:!0,key:this.searchContentAsync};Object(l["d"])(e).then(e=>{if(e.hasOwnProperty("code")&&"ok"===e.code){var a={},n=Object.keys(e.msg),s=[];for(var l in n)if(Object.keys(e.msg[n[l]].re).length>0){a[n[l]]=e.msg[n[l]].re.reverse();var i={};i["label"]=n[l],i["value"]=n[l],s.push(i)}this.hostArr=n,this.hostObj=a,this.host=n[0],this.hostSelect=s;var r=Object.keys(a)[0];""==t?this.initData(r):this.initData(t)}else this.$notify({type:"warning",title:"提示",message:i.msg,duration:1500,position:"bottom-right"})})},initData(t){var e=[],a=[],n=[];e=this.hostObj[t],this.pageTable=e,this.pageTotal=e.length,this.results=e.slice(0,this.pageSize),this.tempContent=e,this.wafDenyCount=this.hostObj[t].length,this.wafAttackIP=i(a),this.wafAttackIPCount=i(a).length;var s=r(n);for(var l in this.gl_method_title=[],this.gl_method=[],s[0]){var o=String(s[0][l]),h=parseInt(s[1][l]);this.gl_method_title.push(o),this.gl_method.push({name:o,value:h})}},onSearch(){}},components:{wafCard:o,WafPage:h},watch:{$route(t,e){},searchContent:{handler:function(t,e){""!==this.searchType&&(""===t?this.results=this.tempContent:(this.results=this.tempContent.filter((function(e){if(e.content[0].indexOf(t)>=0)return!0})),this.pageTotal=this.results.length))}}}},u=c,p=(a("bdb0"),a("2877")),g=Object(p["a"])(u,n,s,!1,null,"2367f6e9",null);e["default"]=g.exports},bdb0:function(t,e,a){"use strict";a("7ce2")}}]);