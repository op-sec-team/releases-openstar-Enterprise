(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c42a843"],{"53cf":function(t,a,e){"use strict";e("add2")},"8c23":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"app-container"},[a("el-dialog",{staticClass:"preview",attrs:{visible:t.showVisible,fullscreen:t.fullscreen},on:{"update:visible":function(a){t.showVisible=a}}},[a("h3",{staticStyle:{float:"left"},attrs:{slot:"title"},slot:"title"},[t._v(" 预览 ")]),a("div",{domProps:{innerHTML:t._s(t.form.denyMsg.msg)}})]),a("el-card",[a("el-row",[a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleSave}},[t._v("保存")])],1)]),a("el-row",[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[a("el-tabs",{model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基础配置",name:"first"}},[a("el-form-item",{attrs:{label:"logDir:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.logPath,callback:function(a){t.$set(t.form,"logPath",a)},expression:"form.logPath"}})],1),a("el-col",{attrs:{span:8}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 调试日志目录；谨慎修改")])])],1),a("el-form-item",{attrs:{label:"jsonDir:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.jsonPath,callback:function(a){t.$set(t.form,"jsonPath",a)},expression:"form.jsonPath"}})],1),a("el-col",{attrs:{span:8}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 规则本地存放目录；谨慎修改")])])],1),a("el-form-item",{attrs:{label:"htmlDir:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{size:"small"},model:{value:t.form.htmlPath,callback:function(a){t.$set(t.form,"htmlPath",a)},expression:"form.htmlPath"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" app_Mod规则中文件存放目录；谨慎修改")])])],1),a("el-form-item",{attrs:{label:"denyMsg:"}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{model:{value:t.form.denyMsg.state,callback:function(a){t.$set(t.form.denyMsg,"state",a)},expression:"form.denyMsg.state"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}})],1),a("span",{staticStyle:{"margin-left":"40px"}},[t._v("状态码：")]),a("el-input",{staticStyle:{width:"110px","line-height":"20px",height:"20px"},attrs:{size:"small"},model:{value:t.form.denyMsg.http_code,callback:function(a){t.$set(t.form.denyMsg,"http_code",t._n(a))},expression:"form.denyMsg.http_code"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 默认拦截信息配置；谨慎修改")]),a("br")]),a("span",[t._v("拦截信息：")]),a("br"),a("el-input",{attrs:{type:"textarea",rows:"8"},model:{value:t.form.denyMsg.msg,callback:function(a){t.$set(t.form.denyMsg,"msg",a)},expression:"form.denyMsg.msg"}}),a("br"),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",size:"mini"},on:{click:t.previewScope}},[t._v("预览")])],1)],1),a("el-tab-pane",{attrs:{label:"高级配置",name:"second"}},[a("el-form-item",{staticClass:"WAF-label",attrs:{label:"WAF防护总开关"}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{model:{value:t.form.Mod_state,callback:function(a){t.$set(t.form,"Mod_state",a)},expression:"form.Mod_state"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}}),a("el-radio",{attrs:{label:"log"}})],1)],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 控制WAF防护总开关 ")])])],1),a("el-form-item",{staticClass:"bold-label",attrs:{label:"请求统计开关"}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{model:{value:t.form.ngx_status,callback:function(a){t.$set(t.form,"ngx_status",a)},expression:"form.ngx_status"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}})],1)],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 控制统计相关计数开关 ")])])],1),a("el-divider"),a("el-form-item",{staticClass:"bold-label",attrs:{label:"集群配置"}},[a("el-col",{attrs:{span:10}},[a("el-radio-group",{model:{value:t.form.autoSync.state,callback:function(a){t.$set(t.form.autoSync,"state",a)},expression:"form.autoSync.state"}},[a("el-radio",{attrs:{label:"Master"}}),a("el-radio",{attrs:{label:"Slave"}})],1)],1)],1),a("el-form-item",{attrs:{label:"同步周期:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"20%"},attrs:{size:"small"},model:{value:t.form.autoSync.timeAt,callback:function(a){t.$set(t.form.autoSync,"timeAt",t._n(a))},expression:"form.autoSync.timeAt"}}),t._v(" s ")],1),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"star-color",staticStyle:{"margin-left":"20px"}},[t._v("*")]),t._v(" 集群模式下规则同步时间周期 ")])],1),a("el-form-item",{attrs:{label:"Master IP:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small"},model:{value:t.form.autoSync.master,callback:function(a){t.$set(t.form.autoSync,"master",a)},expression:"form.autoSync.master"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"star-color",staticStyle:{"margin-left":"20px"}},[t._v("*")]),t._v(" 集群模式下主服务器的IP ")])],1),a("el-form-item",{attrs:{label:"Slave IPs:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:"6",size:"small"},model:{value:t.slaves,callback:function(a){t.slaves=a},expression:"slaves"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 集群模式下，主服务器需要进行配置从服务器的ip列表 ")])])],1),a("el-divider"),a("el-form-item",{staticClass:"bold-label",attrs:{label:"Redis配置:"}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{model:{value:t.form.redis_Mod.state,callback:function(a){t.$set(t.form.redis_Mod,"state",a)},expression:"form.redis_Mod.state"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}})],1)],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 默认开启即可")])])],1),a("el-form-item",{attrs:{label:"IP:"}},[a("el-col",{attrs:{span:7}},[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.form.redis_Mod.ip,callback:function(a){t.$set(t.form.redis_Mod,"ip",a)},expression:"form.redis_Mod.ip"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"40px"}},[t._v("PORT：")]),a("el-input",{staticStyle:{width:"40%"},attrs:{size:"small"},model:{value:t.form.redis_Mod.Port,callback:function(a){t.$set(t.form.redis_Mod,"Port",t._n(a))},expression:"form.redis_Mod.Port"}})],1)],1),a("el-form-item",{attrs:{label:"密码:"}},[a("el-col",{attrs:{span:7}},[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.form.redis_Mod.Password,callback:function(a){t.$set(t.form.redis_Mod,"Password",a)},expression:"form.redis_Mod.Password"}})],1)],1),a("el-divider"),a("el-form-item",{staticClass:"bold-label",attrs:{label:"本地日志:"}},[a("el-col",{attrs:{span:10}},[a("el-radio-group",{model:{value:t.form.log_onLocal.state,callback:function(a){t.$set(t.form.log_onLocal,"state",a)},expression:"form.log_onLocal.state"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}})],1)],1),a("el-col",{attrs:{span:14}},[a("span",{staticStyle:{"margin-left":"20px"}})])],1),a("el-form-item",{attrs:{label:"路径:"}},[a("el-input",{staticStyle:{width:"40%"},attrs:{size:"small"},model:{value:t.form.log_onLocal.path,callback:function(a){t.$set(t.form.log_onLocal,"path",a)},expression:"form.log_onLocal.path"}})],1),a("el-form-item",{attrs:{label:"日志格式化:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:"6"},model:{value:t.log_onLocal_format_tb,callback:function(a){t.log_onLocal_format_tb=a},expression:"log_onLocal_format_tb"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("el-tooltip",[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(" ngx_localtime(时间)"),a("br"),a("br"),t._v(" remoteIp(直连ip)"),a("br"),a("br"),t._v(" host"),a("br"),t._v(" "),a("br"),t._v(" ip(从header头取的用户ip)"),a("br"),a("br"),t._v(" method(请求的方法)"),a("br"),a("br"),t._v(" server_protocol(协议和版本)"),a("br"),a("br"),t._v(" status(状态)"),a("br"),a("br"),t._v(" request_uri(请求的完整url，包含get的args参数)"),a("br"),a("br"),t._v(" useragent,referer,cookie"),a("br"),a("br"),t._v(" ip(从header头取的用户ip)"),a("br"),a("br"),t._v(" query_string(get的args参数)"),a("br"),a("br"),t._v(" headers_data(整个请求头，http2 时为空)"),a("br"),a("br"),t._v(" args_data(所有get参数的值)"),a("br"),a("br"),t._v(" posts_data(所有post参数的值)"),a("br"),a("br"),t._v(" body_bytes_sent(返回内容长度)"),a("br"),a("br"),t._v(" waf_log(waf产生的拦截信息) ")]),a("el-button",{attrs:{type:"text"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 日志格式化支持的变量")])],1)],1)])],1),a("el-form-item",{attrs:{label:"连接符:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small"},model:{value:t.form.log_onLocal.tb_concat,callback:function(a){t.$set(t.form.log_onLocal,"tb_concat",a)},expression:"form.log_onLocal.tb_concat"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 链接符为:json时，日志格式保存为json ")])])],1),a("el-divider"),a("el-form-item",{staticClass:"bold-label",attrs:{label:"API鉴权"}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{model:{value:t.form.api_sign.state,callback:function(a){t.$set(t.form.api_sign,"state",a)},expression:"form.api_sign.state"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}})],1)],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 默认开启即可 ")])])],1),a("el-form-item",{attrs:{label:"Master IP检查:"}},[a("el-col",{attrs:{span:10}},[a("el-radio-group",{model:{value:t.form.api_sign.checkMaster,callback:function(a){t.$set(t.form.api_sign,"checkMaster",a)},expression:"form.api_sign.checkMaster"}},[a("el-radio",{attrs:{label:"on"}}),a("el-radio",{attrs:{label:"off"}})],1)],1),a("el-col",{attrs:{span:14}},[a("span",{staticStyle:{"margin-left":"20px"}})])],1),a("el-form-item",{attrs:{label:"算法选择:"}},[a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择活动区域",size:"small"},model:{value:t.form.api_sign.authority.alg,callback:function(a){t.$set(t.form.api_sign.authority,"alg",a)},expression:"form.api_sign.authority.alg"}},[a("el-option",{attrs:{label:"MD5",value:"MD5"}}),a("el-option",{attrs:{label:"HS256",value:"HS256"}}),a("el-option",{attrs:{label:"HS512",value:"HS512"}})],1)],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 算法支持MD5/HS256/HS512 ")])])],1),a("el-form-item",{attrs:{label:"格式化配置:"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:"6"},model:{value:t.authority_format_tb,callback:function(a){t.authority_format_tb=a},expression:"authority_format_tb"}})],1),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"margin-left":"20px"}},[a("el-tooltip",[a("div",{attrs:{slot:"content"},slot:"content"},[t._v("http_time(从http头中取的时间字段 time)"),a("br"),t._v(" uri(请求的uri) "),a("br"),t._v("useragent,referer,cookie等 常量(自定义的常量，用于增加算法碰撞复杂度)")]),a("el-button",{attrs:{type:"text"}},[a("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 格式化变量")])],1)],1)])],1),a("el-form-item",{attrs:{label:"密钥:"}},[a("el-input",{staticStyle:{width:"40%"},attrs:{size:"small"},model:{value:t.form.api_sign.authority.key,callback:function(a){t.$set(t.form.api_sign.authority,"key",a)},expression:"form.api_sign.authority.key"}})],1)],1)],1),a("div",{staticStyle:{"text-align":"center","margin-top":"60px"}},[a("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("应 用")])],1)],1)],1)],1)],1)},l=[],o=e("a417"),r={data(){return{open:!1,activeName:"first",rules:{userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]},form:{baseDir:"",logPath:"",jsonPath:"",htmlPath:"",denyMsg:{state:"",msg:"",http_code:403},Mod_state:"",ngx_status:"",autoSync:{slaves:[],timeAt:0,state:"",master:""},redis_Mod:{ip:"",Password:"",state:"",Port:6379},log_onLocal:{tb_concat:" ",format_tb:[],path:"",state:""},api_sign:{checkMaster:"",authority:{alg:"",format_tb:[],header_name:"",key:""},state:""},network_Mod:"",cookie_Mod:"",replace_Mod:"",debug_Mod:"",host_method_Mod:"",uri_Mod:"",rewrite_Mod:"",realIpFrom_Mod:"",args_Mod:{state:"",HPP_state:""},ip_Mod:"",referer_Mod:"",header_Mod:"",log_onRemote:{host:"",state:"",sendBufferSize:"",socketType:"",worker_sleep_time:"",port:"",tb_concat:" ",format_tb:[],worker_deal_limit:""},useragent_Mod:"",post_form:"",app_Mod:"",post_Mod:{state:"",HPP_state:""}},slaves:"",log_onLocal_format_tb:"",authority_format_tb:"",showVisible:!1,fullscreen:!0}},watch:{$route:{handler:function(t){},immediate:!0}},mounted(){var t=this;t.initData()},methods:{initData(){var t={action:"get",mod:"base"};Object(o["b"])(t).then(t=>{this.form=t.msg,this.slaves=JSON.stringify(this.form.autoSync.slaves),this.log_onLocal_format_tb=JSON.stringify(this.form.log_onLocal.format_tb),this.authority_format_tb=JSON.stringify(this.form.api_sign.authority.format_tb)})},onSubmit(){var t;this.form.autoSync.slaves=JSON.parse(this.slaves),this.form.log_onLocal.format_tb=JSON.parse(this.log_onLocal_format_tb),this.form.api_sign.authority.format_tb=JSON.parse(this.authority_format_tb),this.form.denyMsg.http_code?this.form.denyMsg.http_code=parseInt(this.form.denyMsg.http_code):delete this.form.denyMsg.http_code;var a=JSON.stringify(this.form);t={action:"set",mod:"base",value:a},Object(o["b"])(t).then(t=>{"ok"===t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})},handleSave(){var t={action:"save",mod:"all_Mod"};Object(o["h"])(t).then(t=>{"ok"==t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})},previewScope(){this.showVisible=!0}}},i=r,n=(e("53cf"),e("2877")),c=Object(n["a"])(i,s,l,!1,null,"2ed83f86",null);a["default"]=c.exports},add2:function(t,a,e){}}]);