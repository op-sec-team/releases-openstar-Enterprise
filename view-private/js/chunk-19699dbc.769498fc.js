(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19699dbc"],{"1c31":function(t,a,e){"use strict";e.d(a,"a",(function(){return n})),e.d(a,"c",(function(){return s})),e.d(a,"d",(function(){return o})),e.d(a,"b",(function(){return l}));var i=e("b775"),r=(e("4328"),e("365c"));function n(t){return Object(i["a"])({url:""+r["a"].report.secGlobal,method:"get"})}function s(t){return Object(i["a"])({url:""+r["a"].report.secTrendx,method:"get",params:t})}function o(t){return Object(i["a"])({url:""+r["a"].report.secWafLog,method:"get",params:t})}function l(){return Object(i["a"])({url:""+r["a"].report.secOwasp,method:"get"})}},9406:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"dashboard",attrs:{gutter:20}},[a("wafCard",{attrs:{card:t.f1}}),a("wafCard",{attrs:{card:t.f2}}),a("wafCard",{attrs:{card:t.f3}}),a("wafCard",{attrs:{card:t.f4}})],1),a("el-row",{staticClass:"custom-col",attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-card",{staticStyle:{height:"350px, padding:0px"},attrs:{shadow:"never"}},[a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{width:"470px",height:"350px"},attrs:{id:"draw1"}})]),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{width:"470px",height:"350px"},attrs:{id:"draw2"}})])],1)],1)],1),a("el-row",{staticClass:"custom-col",attrs:{gutter:20}},[a("el-col",{staticStyle:{"min-height":"190px"},attrs:{span:12}},[a("h3",[t._v("自定义拦截规则")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.customRule}},[a("el-table-column",{staticStyle:{width:"50%"},attrs:{prop:"site",label:"拦截域名"}}),a("el-table-column",{staticStyle:{width:"50%"},attrs:{prop:"total",label:"拦截次数"}})],1)],1),a("el-col",{attrs:{span:12}},[a("h3",[t._v("CC攻击防护")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.customRule2}},[a("el-table-column",{staticStyle:{width:"25%"},attrs:{prop:"host",label:"域名"}}),a("el-table-column",{staticStyle:{width:"25%"},attrs:{prop:"site",label:"拦截IP"}}),a("el-table-column",{staticStyle:{width:"25%"},attrs:{prop:"total",label:"拦截次数"}}),a("el-table-column",{staticStyle:{width:"25%"},attrs:{prop:"address",label:"地理位置"}})],1)],1)],1),a("el-row",[a("el-col",{staticClass:"custom-col",attrs:{span:24}},[a("el-card",{staticStyle:{"padding-top":"0"},attrs:{shadow:"never"}},[a("div",{staticStyle:{"line-height":"40px",height:"40px"},attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{float:"left"}},[a("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(a){return t.initData(7,7)}}},[t._v("7天")]),t._v("   "),a("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(a){return t.initData(30,30)}}},[t._v("30天")])]),a("div",{staticStyle:{float:"left","margin-left":"20px"}},[a("div",[a("label",[t._v("开始时间：")]),a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh.date1,callback:function(a){t.$set(t.sh,"date1",a)},expression:"sh.date1"}}),t._v(" - "),a("label",[t._v("结束时间：")]),a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh.date2,callback:function(a){t.$set(t.sh,"date2",a)},expression:"sh.date2"}}),t._v("   "),a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:function(a){return t.initData(8,8)}}})],1)]),a("div",{staticStyle:{float:"right"}},[t._v(" 最小刻度："),a("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(a){return t.draw3("10m")}}},[t._v("10min")]),t._v("   "),a("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(a){return t.draw3("1h")}}},[t._v("1h")]),t._v("   "),a("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(a){return t.draw3("1d")}}},[t._v("1d")])])]),a("div",{staticStyle:{width:"100%",height:"480px"},attrs:{id:"wafTrend"}})])],1)],1)],1)},r=[],n=(e("14d9"),e("164e")),s=e.n(n),o=e("bc3a"),l=e.n(o),c=e("ec1b"),u=e.n(c),d=e("1c31");const h=()=>e.e("chunk-518ff832").then(e.bind(null,"8af7")),f={dataItem:{display:"flex",flexBasis:"50%",alignItems:"center",marginTop:"20px"},dataItemImg:{color:"#1890ff",marginTop:"auto",marginBottom:"auto",fontSize:"60px",marginRight:"30px"},dataItemUnit:{height:"60px",display:"flex",flexBasis:"50%",flexDirection:"column",justifyContent:"space-between"},dataTitle:{color:"#666",fontSize:"12px"},dataAmount:{color:"#333",fontSize:"24px"}},p=(t,a)=>({color:["rgba(60, 144, 247, 1)","rgba(244, 205, 73, 1)","rgba(85, 191, 192, 1)","rgba(94, 190, 103, 1)","rgba(224, 86, 103, 1)","rgba(124, 75, 216, 1)"],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",x:"right",y:"center",itemGap:5,icon:"circle",textStyle:{fontSize:12,fontFamily:"Monaco"},data:[],formatter:t=>{let e,i=0;return a.forEach(a=>{i+=a.value,a.name==t&&(e=a.value)}),t.padEnd(18," ")+((100*e/i).toFixed(2)+"% ").padStart(8)+e.toString().padStart(5)}},series:[{name:t,type:"pie",radius:"44%",center:["20%","50%"],label:{show:!1},labelLine:{normal:{show:!1},show:!1},data:[]}]});var m={data(){return{styles:f,mod_arr:[],f1:{img:"fa fa-user-o",header:"访问统计",content:0,contentTag:"已访问",todayCount:-1,todayCountTag:"今日"},f2:{img:"fa fa-free-code-camp",header:"拦截总数",content:0,contentTag:"已拦截",todayCount:-1,todayCountTag:"LOG"},f3:{img:"fa fa-bolt",header:"CC统计",content:0,contentTag:"攻击次数",todayCount:-1,todayCountTag:"今日"},f4:{img:"fa fa-hourglass-o",header:"自定义拦截",content:0,contentTag:"攻击次数",todayCount:-1,todayCountTag:"今日"},chartData:{chartPie_inlineTitle_data:[],chartPie_outlineTitle_data:[],chartPie_inline_data:[],chartPie_outline_data:[]},customRule:[],customRule2:[],sh:{date1:"",date2:""},waf_start_day:0,waf_end_day:0,waf_log:[],waf_deny:[],option6:{title:{text:""},tooltip:{trigger:"axis"},toolbox:{x:"80%",y:"top",show:!0,feature:{mark:{show:!0},saveAsImage:{show:!0},dataView:{show:!0}}},legend:{data:["waf_log","waf_deny","waf_req"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:[{type:"value"}],series:[{name:"waf_log",type:"line",data:[]},{name:"waf_deny",type:"line",data:[]},{name:"waf_req",type:"line",data:[]}]}}},mounted(){this.draw1(),this.draw3("init"),this.draw2()},methods:{draw1(){Object(d["a"])().then(t=>{if(t.hasOwnProperty("code")&&"ok"===t.code){console.log(t),this.customIn(t.msg);var a=t.msg.ip_mod,e=0,i=new Array;for(var r in a){var n,o,l=r.split(" ")[0].split("_");l.length>=2?(o=l[1],n=l[0]):(o=l[0],n="*"),e+=parseInt(a[r]),i.push({host:n,site:o,total:parseInt(a[r])})}this.f3.content=e,this.customCC(i);var c=t.msg.waf;for(var u in c){var d=parseInt(c[u]),h=String(u);0!=d&&this.chartData.chartPie_outline_data.push({value:d,name:h})}for(var f in c){var m=String(f);this.chartData.chartPie_outlineTitle_data.push(m)}console.log(this.chartData.chartPie_outlineTitle_data),this.f1.content=parseInt(t.msg["request count"]),this.f2.content=parseInt(t.msg["gl_waf"]["deny"]),this.f2.todayCount=parseInt(t.msg["gl_waf"]["log"]);let b=document.getElementById("draw1"),x=s.a.init(b),D=p("记录请求",this.chartData.chartPie_outline_data);D.legend.data=this.chartData.chartPie_outlineTitle_data,D.series[0].data=this.chartData.chartPie_outline_data;var w=[];for(var y in this.chartData.chartPie_outline_data){var g={},_=this.chartData.chartPie_outline_data[y]["name"],v=this.chartData.chartPie_outline_data[y]["value"];g[_]=v,w.push(g)}this.mod_arr=w,console.log(D),x.setOption(D),console.log(this.f1,this.f2)}else this.$notify({type:"warning",title:"提示",message:t.msg,duration:1500,position:"bottom-right"})})},draw2(){Object(d["b"])().then(t=>{if(t.hasOwnProperty("code")&&"ok"===t.code){console.log(t);var a=t.msg;for(var e in a){var i=parseInt(a[e]),r=String(e);0!=i&&this.chartData.chartPie_inline_data.push({value:i,name:r})}for(var n in a){var o=String(n);this.chartData.chartPie_inlineTitle_data.push(o)}let f=document.getElementById("draw2"),m=s.a.init(f),w=p("waf拦截",this.chartData.chartPie_inline_data);w.legend.data=this.chartData.chartPie_inlineTitle_data,w.series[0].data=this.chartData.chartPie_inline_data;var l=[];for(var c in this.chartData.chartPie_inline_data){var u={},d=this.chartData.chartPie_inline_data[c]["name"],h=this.chartData.chartPie_inline_data[c]["value"];u[d]=h,l.push(u)}this.mod_arr=l,m.setOption(w)}else this.$notify({type:"warning",title:"提示",message:t.msg,duration:1500,position:"bottom-right"})})},async draw3(t){if(0==this.waf_start_day)var a=new Date((new Date).getTime()-6048e5),e=new Date;else a=new Date(this.waf_start_day),e=new Date(this.waf_end_day);var i=this.DateFormt(a,"yyyy-MM-dd"),r=this.DateFormt(e,"yyyy-MM-dd");if("init"==String(t)){var n,o,l={key:"waf_log",stime:i,etime:r},c={key:"waf_deny",stime:i,etime:r};n=await Object(d["c"])(l),o=await Object(d["c"])(c),this.waf_log=n.msg,this.waf_deny=o.msg}var u={xData:[],waf_log:[],waf_deny:[],waf_req:[]};switch(String(t)){case"1d":var h=this.X_list(a,e,"1d");for(var f in h){var p=0,m=0,w=h[f];for(var y in w){var g=w[y];p+=this.waf_log[g]||0,m+=this.waf_deny[g]||0}var _=p+m;u["xData"].push(f),u["waf_log"].push(p),u["waf_deny"].push(m),u["waf_req"].push(_)}break;case"1h":h=this.X_list(a,e,"1h");for(var f in h){p=0,m=0,w=h[f];for(var y in w){g=w[y];p+=this.waf_log[g]||0,m+=this.waf_deny[g]||0}_=p+m;u["xData"].push(f),u["waf_log"].push(p),u["waf_deny"].push(m),u["waf_req"].push(_)}break;case"10m":h=this.X_list(a,e,"10m");for(var f in h){g=h[f],p=this.waf_log[g]||0,m=this.waf_deny[g]||0,_=p+m;u["xData"].push(g),u["waf_log"].push(p),u["waf_deny"].push(m),u["waf_req"].push(_)}break;default:h=this.X_list(a,e,"10m");for(var f in h){g=h[f],p=this.waf_log[g],m=this.waf_deny[g],_=p+m;u["xData"].push(g),u["waf_log"].push(p),u["waf_deny"].push(m),u["waf_req"].push(_)}break}let v=document.getElementById("wafTrend"),b=s.a.init(v);this.option6.xAxis.data=u["xData"],this.option6.series[0].data=u["waf_log"],this.option6.series[1].data=u["waf_deny"],this.option6.series[2].data=u["waf_req"],b.setOption(this.option6)},initData(t,a){if(7==t)this.waf_start_day=new Date((new Date).getTime()-6048e5),this.waf_end_day=new Date,this.draw3("init");else if(30==t)this.waf_start_day=new Date((new Date).getTime()-2592e6),this.waf_end_day=new Date,this.draw3("init");else{var e,i,r=/^(\d{4})-(\d{2})-(\d{2})$/,n=this.sh.date1,s=this.sh.date2,o=(r.exec(n),!1);r.test(n)&&RegExp.$2<=12&&RegExp.$3<=31&&(e=new Date(n+" 00:00:00"),o=!0),r.test(n)&&RegExp.$2<=12&&RegExp.$3<=31&&(i=new Date(s+" 00:00:00"),o=!0),o||this.$notify({type:"warning",title:"提示",message:"请输入正确的时间格式",duration:1500,position:"bottom-right"}),i>e?(this.waf_start_day=e,this.waf_end_day=i,this.draw3("init")):this.$notify({type:"warning",title:"提示",message:"结束时间小于开始时间",duration:1500,position:"bottom-right"})}},customIn(t){var a=t.host_mod,e=0,i=new Array,r=new Array,n=new Array;for(var s in a){e+=parseInt(a[s]);var o=s.split(" ")[0],l=a[s];if(-1===r.indexOf(o))r.push(o),n.push(l);else{var c=r.indexOf(o);n[c]=n[c]+l}}for(var s in r)i.push({site:r[s],total:n[s]});this.customRule=i,this.f4.content=e},customCC(t){var a=this,e=new Array,i=t.map((function(t){t["host"];var a=t["site"],e=(t["total"],"http://ip-api.com/json/"+String(a)+"?lang=zh-CN");return l.a.get(e)}));Promise.all(i).then((function(i){var r=new Array;for(var n in i){var s=i[n],o="火星",l="";200===s["status"]&&(o=s["data"]["country"]+(s["data"]["city"]||""),l=s["data"]["query"]);var c={address:o,ip:l};r.push(c)}for(var n in t){var u=t[n]["host"],d=t[n]["site"],h=t[n]["total"];c={host:u,site:d,total:h,address:r[n]["address"]};e.push(c)}a.customRule2=e}))}},components:{wafCard:h,CountTo:u.a}},w=m,y=(e("b6b3"),e("2877")),g=Object(y["a"])(w,i,r,!1,null,"c0a65106",null);a["default"]=g.exports},b6b3:function(t,a,e){"use strict";e("c30b")},c30b:function(t,a,e){},ec1b:function(t,a,e){!function(a,e){t.exports=e()}(0,(function(){return function(t){function a(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,a),r.l=!0,r.exports}var e={};return a.m=t,a.c=e,a.i=function(t){return t},a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},a.p="/dist/",a(a.s=2)}([function(t,a,e){var i=e(4)(e(1),e(5),null,null);t.exports=i.exports},function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e(3);a.default={props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:2017},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:0,validator:function(t){return t>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default:function(t,a,e,i){return e*(1-Math.pow(2,-10*t/i))*1024/1023+a}}},data:function(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown:function(){return this.startVal>this.endVal}},watch:{startVal:function(){this.autoplay&&this.start()},endVal:function(){this.autoplay&&this.start()}},mounted:function(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start:function(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=(0,i.requestAnimationFrame)(this.count)},pauseResume:function(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause:function(){(0,i.cancelAnimationFrame)(this.rAF)},resume:function(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,(0,i.requestAnimationFrame)(this.count)},reset:function(){this.startTime=null,(0,i.cancelAnimationFrame)(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count:function(t){this.startTime||(this.startTime=t),this.timestamp=t;var a=t-this.startTime;this.remaining=this.localDuration-a,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(a,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(a,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(a/this.localDuration):this.printVal=this.localStartVal+(this.localStartVal-this.startVal)*(a/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),a<this.localDuration?this.rAF=(0,i.requestAnimationFrame)(this.count):this.$emit("callback")},isNumber:function(t){return!isNaN(parseFloat(t))},formatNumber:function(t){t=t.toFixed(this.decimals),t+="";var a=t.split("."),e=a[0],i=a.length>1?this.decimal+a[1]:"",r=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;r.test(e);)e=e.replace(r,"$1"+this.separator+"$2");return this.prefix+e+i+this.suffix}},destroyed:function(){(0,i.cancelAnimationFrame)(this.rAF)}}},function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e(0),r=function(t){return t&&t.__esModule?t:{default:t}}(i);a.default=r.default,"undefined"!=typeof window&&window.Vue&&window.Vue.component("count-to",r.default)},function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=0,r="webkit moz ms o".split(" "),n=void 0,s=void 0;if("undefined"==typeof window)a.requestAnimationFrame=n=function(){},a.cancelAnimationFrame=s=function(){};else{a.requestAnimationFrame=n=window.requestAnimationFrame,a.cancelAnimationFrame=s=window.cancelAnimationFrame;for(var o=void 0,l=0;l<r.length&&(!n||!s);l++)o=r[l],a.requestAnimationFrame=n=n||window[o+"RequestAnimationFrame"],a.cancelAnimationFrame=s=s||window[o+"CancelAnimationFrame"]||window[o+"CancelRequestAnimationFrame"];n&&s||(a.requestAnimationFrame=n=function(t){var a=(new Date).getTime(),e=Math.max(0,16-(a-i)),r=window.setTimeout((function(){t(a+e)}),e);return i=a+e,r},a.cancelAnimationFrame=s=function(t){window.clearTimeout(t)})}a.requestAnimationFrame=n,a.cancelAnimationFrame=s},function(t,a){t.exports=function(t,a,e,i){var r,n=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(r=t,n=t.default);var o="function"==typeof n?n.options:n;if(a&&(o.render=a.render,o.staticRenderFns=a.staticRenderFns),e&&(o._scopeId=e),i){var l=Object.create(o.computed||null);Object.keys(i).forEach((function(t){var a=i[t];l[t]=function(){return a}})),o.computed=l}return{esModule:r,exports:n,options:o}}},function(t,a){t.exports={render:function(){var t=this,a=t.$createElement;return(t._self._c||a)("span",[t._v("\n  "+t._s(t.displayValue)+"\n")])},staticRenderFns:[]}}])}))}}]);