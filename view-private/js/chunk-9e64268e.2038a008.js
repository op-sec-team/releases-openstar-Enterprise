(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9e64268e"],{"05b5":function(t,e,a){},"09ee":function(t,e,a){},"17d0":function(t,e,a){},"1fbe":function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"h",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"g",(function(){return m})),a.d(e,"c",(function(){return p})),a.d(e,"f",(function(){return h}));var o=a("b775"),i=a("4328"),r=a.n(i),s=a("365c");function n(t){return Object(o["a"])({url:""+s["a"].fourtier.getStream,method:"get",params:t})}function l(t){return Object(o["a"])({url:""+s["a"].fourtier.addStream,method:"post",data:r.a.stringify(t)})}function c(t){return Object(o["a"])({url:""+s["a"].fourtier.delStream,method:"post",data:r.a.stringify(t)})}function u(t){return Object(o["a"])({url:""+s["a"].fourtier.setStream,method:"post",data:r.a.stringify(t)})}function d(t){return Object(o["a"])({url:""+s["a"].fourtier.getSip,method:"get",params:t})}function m(t){return Object(o["a"])({url:""+s["a"].fourtier.setSip,method:"post",data:r.a.stringify(t)})}function p(t){return Object(o["a"])({url:""+s["a"].fourtier.configDict,method:"get",params:t})}function h(t){return Object(o["a"])({url:""+s["a"].fourtier.configDict,method:"post",data:r.a.stringify(t)})}},"3de1":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("el-card",{attrs:{shadow:"never"}},[e("el-tabs",{on:{"tab-click":t.handleClick}},[e("el-tab-pane",{attrs:{label:"IP黑白名单"}},[0==t.tabindex?e("Ipbwlist"):t._e()],1),e("el-tab-pane",{attrs:{label:"高级规则"}},[1==t.tabindex?e("Advancedrule"):t._e()],1),e("el-tab-pane",{attrs:{label:"频率规则"}},[2==t.tabindex?e("Frequencyrule"):t._e()],1)],1)],1)],1)},i=[],r=function(){var t=this,e=t._self._c;return e("div",[e("el-row",{staticStyle:{"margin-bottom":"10px","margin-left":"0","margin-right":"0"},attrs:{gutter:10}},[e("div",{staticStyle:{width:"300px",float:"left"}},[e("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e("div",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("添加")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleSave}},[t._v("保存")])],1)]),e("el-row",{staticStyle:{margin:"20px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticStyle:{"margin-right":"20px"}},[t._v("模块开关:")]),e("el-radio-group",{on:{change:t.setbaseState},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[e("el-radio",{attrs:{label:"on"}}),e("el-radio",{attrs:{label:"off"}})],1)],1),e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{float:"right"}},[e("span",{staticStyle:{"margin-right":"20px"}},[t._v("版本号："),e("span",{staticStyle:{color:"rgba(255, 141, 26, 1)"}},[t._v(t._s(t.version))])]),e("span",[t._v("数量："),e("span",{staticStyle:{color:"rgba(255, 141, 26, 1)"}},[t._v(t._s(t.pageTotal))])])])])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.sipList,border:""}},[e("el-table-column",{attrs:{prop:"port",label:"服务端口","min-width":"20%"}}),e("el-table-column",{attrs:{prop:"ip",label:"ip","min-width":"20%"}}),e("el-table-column",{attrs:{prop:"action",label:"动作","min-width":"20%"}}),e("el-table-column",{attrs:{label:"操作",align:"center","min-width":"12%","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-popover",{attrs:{placement:"top",width:"160"},model:{value:a.row.visible,callback:function(e){t.$set(a.row,"visible",e)},expression:"scope.row.visible"}},[e("p",[t._v("确定要删除吗?")]),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){a.row.visible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleDel(a.row)}}},[t._v("确定")])],1),e("el-button",{staticStyle:{color:"red","margin-left":"10px"},attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),e("ip-json-gui",{attrs:{visibleProp:t.open,title:t.title,formData:t.form,width:"60%"},on:{hideDialog:t.cancel,asyncEditConfirm:t.editConfirm}})],1)},s=[],n=(a("f8c9"),a("14d9"),function(){var t=this,e=t._self._c;return e("el-dialog",t._g(t._b({attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:t.open,title:t.title,width:"80%"},on:{"update:visible":function(e){t.open=e},close:t.cancel}},"el-dialog",t.$attrs,!1),t.$listeners),[e("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"图形化配置",name:"gui"}},[e("el-form",{ref:"editform",attrs:{model:t.guiFormData,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"匹配端口"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"请输入匹配端口",width:"60%"},model:{value:t.guiFormData.port,callback:function(e){t.$set(t.guiFormData,"port",t._n(e))},expression:"guiFormData.port"}})],1),e("el-col",{attrs:{span:12}},[e("span",{staticStyle:{"margin-left":"20px"}},[e("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 4层端口，*时表示任意端口")])])],1),e("el-form-item",{attrs:{label:"IP"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"请输入ip"},model:{value:t.guiFormData.ipAddress,callback:function(e){t.$set(t.guiFormData,"ipAddress",e)},expression:"guiFormData.ipAddress"}})],1)],1),e("el-form-item",{attrs:{label:"执行动作"}},[e("el-col",{attrs:{span:12}},[e("el-select",{attrs:{placeholder:"请选择动作"},model:{value:t.guiFormData.value,callback:function(e){t.$set(t.guiFormData,"value",e)},expression:"guiFormData.value"}},t._l(t.valueOption,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("el-form-item",{attrs:{label:"生效时间"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"请输入生效时间"},model:{value:t.guiFormData.time,callback:function(e){t.$set(t.guiFormData,"time",t._n(e))},expression:"guiFormData.time"}})],1),e("el-col",{attrs:{span:12}},[e("span",{staticStyle:{"margin-left":"20px"}},[e("span",{staticClass:"star-color"},[t._v("*")]),t._v(" 单位s；0表示永久生效")])])],1)],1)],1),e("el-tab-pane",{attrs:{label:"原始json配置",name:"originalJson"}},["originalJson"==t.activeTab?e("json-dialog",{ref:"jsonDialog",attrs:{contentsProp:t.form.contents,codeProp:t.code,width:"60%"}}):t._e()],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)}),l=[],c=a("2eac"),u=a("0644"),d=a.n(u),m={components:{JsonDialog:c["a"]},props:{visibleProp:{type:Boolean,default:!1},title:{type:String,default:"添加"},formData:{type:Object}},data(){return{code:'\n            \n{\n    "ip": "8000_111.111.111.111|1.1.1.1",\n    "value": "deny/allow/log",\n    "time": 120\n}\n-- IP：使用 PORT + 下划线时，表示仅对这个服务端口生效\n-- value: 对应 拦截 放行 记录日志操作\n\n\n',guiFormData:{port:"",ipAddress:"",value:"",time:0},form:this.formData,open:this.visibleProp,activeTab:"gui",valueOption:[{label:"拦截",value:"deny"},{label:"放行",value:"allow"},{label:"仅记录",value:"log"}]}},watch:{visibleProp(t){this.open=t},formData(t){this.form=t,this.jsonToGui()}},methods:{handleTabClick(t){"originalJson"===t.name?this.guiToJson():"gui"===t.name&&(this.form.contents=this.$refs.jsonDialog.contents,this.jsonToGui())},jsonToGui(){if(this.guiFormData=d()(this.form.contents),!this.guiFormData["ip"])return;const t=this.guiFormData.ip.split("_");console.log(t),2===t.length?(this.$set(this.guiFormData,"ipAddress",t[1]),this.$set(this.guiFormData,"port",t[0])):(this.$set(this.guiFormData,"ipAddress",this.guiFormData.ip),this.$set(this.guiFormData,"port","*"))},guiToJson(){this.guiFormData.port&&"*"!==this.guiFormData.port?this.guiFormData.ip=`${this.guiFormData.port||""}_${this.guiFormData.ipAddress||""}`:this.guiFormData.ip=this.guiFormData.ipAddress,this.form.contents=d()(this.guiFormData),delete this.form.contents.ipAddress,delete this.form.contents.port},cancel(){this.$emit("hideDialog"),this.reset()},reset(){this.form={contents:{}}},submitForm(){if("gui"===this.activeTab)return void this.submitGui();const t=d()(this.$refs.jsonDialog.contents);if(!this.isJSON(t))return this.$message.error("配置内容:json格式错误/没有内容"),!1;if("编辑"===this.title);else{var e={action:"add",form:this.form,contents:t};this.$emit("asyncEditConfirm",e)}},submitGui(){this.guiToJson(),this.$emit("asyncEditConfirm",{action:"编辑"===this.title?"set":"add",form:this.form})},isJSON(t){if("string"==typeof t)try{var e=JSON.parse(t);return!("object"!=typeof e||!e)}catch(a){return!1}else if("object"==typeof t&&t)return!0}}},p=m,h=(a("d358"),a("2877")),f=Object(h["a"])(p,n,l,!1,null,"b6799f34",null),g=f.exports,b=a("1fbe"),v=a("a417"),y={components:{IpJsonGui:g},data(){return{sipList:[],search:"",tempList:[],pageTotal:0,state:"",version:"",open:!1,title:"",form:{contents:{}}}},mounted(){this.getList()},methods:{editConfirm(t){var e={action:"set",value:t.form.contents.value,ip:t.form.contents.ip,time:t.form.contents.time};Object(b["g"])(e).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList(1)):this.$notify({title:"警告",message:t.msg,type:"warning"})})},getList(){var t={action:"getdict"};Object(b["d"])(t).then(t=>{var e=t.msg,a=[];this.pageTotal=e.count,this.version=e.state.G_version,this.state=e.state.state,delete e.count,delete e.state,Reflect.ownKeys(e).forEach((function(t){var o={};o.action=e[t];var i=[];-1!=t.indexOf("_")?(i=t.split("_"),o.port=i[0],o.ip=i[1]):(o.port="*",o.ip=t),a.push(o)})),this.sipList=a,this.tempList=a})},reset(){this.form={contents:{}}},setbaseState(){var t={G_version:this.version,state:this.state},e={action:"set",mod:"sbase",id:"sip_Mod",value:JSON.stringify(t)};Object(v["b"])(e).then(t=>{"ok"===t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})},cancel(){this.open=!1,this.reset()},handleAdd(){this.reset(),this.title="添加",this.open=!0},handleDel(t){var e=t.ip;"*"!=t.port&&(e=t.port+"_"+t.ip);var a={action:"del",ip:e,value:t.action};Object(b["g"])(a).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList()):this.$notify({title:"警告",message:t.msg,type:"warning"})})},handleSave(){var t={action:"save",mod:"all_Mod"};Object(v["h"])(t).then(t=>{"ok"==t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})}},watch:{search:{handler:function(t){this.sipList=""===t?this.tempList:this.tempList.filter((function(e){if(e.action.indexOf(t)>=0||e.ip.indexOf(t)>=0||e.port.indexOf(t)>=0)return!0}))}}}},w=y,D=Object(h["a"])(w,r,s,!1,null,"2791aa7f",null),_=D.exports,j=function(){var t=this,e=t._self._c;return e("div",[e("Adv",{ref:"advanced",attrs:{name:"sapp_Mod"},on:{handleSet:t.handleSet,handleAdd:t.handleAdd}}),e("adv-json-gui",{attrs:{visibleProp:t.open,title:t.title,formData:t.form,width:"60%"},on:{hideDialog:t.cancel,asyncEditConfirm:t.editConfirm}})],1)},O=[],k=function(){var t=this,e=t._self._c;return e("el-dialog",t._g(t._b({attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:t.open,title:t.title,width:"80%"},on:{"update:visible":function(e){t.open=e},close:t.cancel}},"el-dialog",t.$attrs,!1),t.$listeners),[e("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"图形化配置",name:"gui"}},[e("el-form",{ref:"editform",attrs:{model:t.guiFormData,"label-width":"80px"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"规则Id"}},[e("el-input",{attrs:{placeholder:"输入id信息"},model:{value:t.guiFormData.id,callback:function(e){t.$set(t.guiFormData,"id",e)},expression:"guiFormData.id"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"描述信息"}},[e("el-input",{attrs:{placeholder:"输入描述信息"},model:{value:t.guiFormData.des,callback:function(e){t.$set(t.guiFormData,"des",e)},expression:"guiFormData.des"}})],1)],1)],1),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"是否启用"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:t.switchChange},model:{value:t.guiFormData["switch"],callback:function(e){t.$set(t.guiFormData,"switch",t._n(e))},expression:"guiFormData['switch']"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"WAF标识"}},[e("el-input",{attrs:{placeholder:"输入tag"},model:{value:t.guiFormData.waf,callback:function(e){t.$set(t.guiFormData,"waf",e)},expression:"guiFormData.waf"}})],1)],1)],1),e("el-row",[e("el-form-item",{attrs:{label:"匹配规则"}},[e("adv",{ref:"adv",attrs:{ruleData:t.ruleData,tableDataProps:t.matchRulesData}})],1)],1),e("el-row",[e("el-form-item",{attrs:{label:"动作函数"}},[e("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择"},on:{change:function(e){return t.$forceUpdate()}},model:{value:t.guiFormData["funcName"],callback:function(e){t.$set(t.guiFormData,"funcName",e)},expression:"guiFormData['funcName']"}},t._l(t.funcOptions,(function(t){return e("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),1)],1)],1),e("el-row",[e("el-form-item",{attrs:{label:"函数参数"}},[e("vue-json-editor",{staticClass:"editorG",attrs:{mode:"code",lang:"zh"},model:{value:t.guiFormData.funcArgu,callback:function(e){t.$set(t.guiFormData,"funcArgu",e)},expression:"guiFormData.funcArgu"}})],1)],1)],1)],1),e("el-tab-pane",{attrs:{label:"原始json配置",name:"originalJson"}},["originalJson"==t.activeTab?e("json-dialog",{ref:"jsonDialog",attrs:{contentsProp:t.form.contents,codeProp:t.code,width:"60%"}}):t._e()],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)},x=[],S=a("9f28"),F=a("45a3"),T=a("6ae5"),R={inheritAttrs:!1,components:{JsonDialog:c["a"],Adv:S["a"],vueJsonEditor:F["a"]},props:{visibleProp:{type:Boolean,default:!1},title:{type:String,default:"添加"},formData:{type:Object}},data(){return{code:'\n\n{\n    "state": "on|off 开关",\n    "id": "sapp_Mod-1000",\n    "des": "规则描述信息",\n    "waf": "nil/owasp标识",\n    "server_port": ["匹配内容", "匹配标识", "是否取反"],\n    "ip": ["匹配内容", "匹配标识", "是否取反"],\n    "action": "refile",\n    "func":[\n      "tcpfunc (函数名称)",\n      {\n        1,2,3,"函数参数..."\n      }\n    ]\n}el\n\n',open:this.visibleProp,form:this.formData,activeTab:"gui",guiFormData:{id:"",switch:1,des:"",waf:"",server_port:[],ip:[],action:"func",func:[]},funcOptions:[],ruleData:{nameMatch:["ip","server_port"],rule:["ip",[["106.37.236.170","1.1.1.1"],"list",!0]]},matchRulesData:[]}},watch:{visibleProp(t){this.open=t},formData(t){this.form=t,this.jsonToGui()}},mounted(){this.getFuncOptions()},methods:{getFuncOptions(){var t={action:"get",mod:"splugin_Mod",id:""};Object(b["c"])(t).then(t=>{var e=t.msg,a=[];for(var o in e)if("count"!=o&&"G_version"!=o){var i={};i.name=o,a.push(i)}this.funcOptions=a})},isJSON(t){if("string"==typeof t)try{var e=JSON.parse(t);return!("object"!=typeof e||!e)}catch(a){return!1}else if("object"==typeof t&&t)return!0},reset(){this.form={contents:{}}},cancel(){this.$emit("hideDialog"),this.reset()},submitForm(){if("gui"===this.activeTab)return void this.submitGui();const t=d()(this.$refs.jsonDialog.contents);if(!this.isJSON(t))return this.$message.error("配置内容:json格式错误/没有内容"),!1;if("修改"===this.title){var e={action:"set",form:{...this.form,contents:t}};this.$emit("asyncEditConfirm",e)}else{var a={action:"add",form:this.form,contents:t};this.$emit("asyncEditConfirm",a)}},handleClick(t){"originalJson"===t.name?this.guiToJson():"gui"===t.name&&(this.form.contents=this.$refs.jsonDialog.contents,this.jsonToGui())},guiToJson(){const t=this.$refs.adv;t.tableData.forEach(t=>{this.$set(this.guiFormData,t.dataTmpselectwz,t.dataLocalruleData.rule)});const e=d()(this.guiFormData);e.state=e.switch?"on":"off",e["func"]=[e.funcName,e.funcArgu],e["server_port"]&&(e.server_port=e.server_port[1]||["","",!1]),e["ip"]&&(e.ip=e.ip[1]||["","",!1]),e["action"]="func",delete e.switch,delete e.funcName,delete e.funcArgu,this.form.contents=e},jsonToGui(){this.guiFormData=d()(this.form.contents),this.guiFormData.switch="on"===this.guiFormData.state?1:0,this.form.contents["func"]?(this.guiFormData["funcName"]=this.guiFormData.func[0]||"",this.guiFormData["funcArgu"]=this.guiFormData.func[1]||{}):(this.guiFormData["funcName"]="",this.guiFormData["funcArgu"]={}),this.guiFormData["ip"]=this.guiFormData["ip"]||["",null,!1],this.guiFormData["server_port"]=this.guiFormData["server_port"]||["",null,!1],this.matchRulesData=[];for(let t in this.guiFormData)if(-1!==T["a"].indexOf(t)){let e={dataTmpselectmatch:"",dataTmpselectwz:t,dataRuleValue:this.guiFormData[t][0],dataLocalruleData:{rule:[t,this.guiFormData[t]]}};this.matchRulesData.push(e)}},submitGui(){this.guiToJson(),this.$emit("asyncEditConfirm",{action:"修改"===this.title?"set":"add",form:this.form})},switchChange(){this.$forceUpdate()}}},$=R,A=(a("92ab"),Object(h["a"])($,k,x,!1,null,"3732fd8e",null)),z=A.exports,L=function(){var t=this,e=t._self._c;return e("div",[e("el-row",{staticStyle:{"margin-bottom":"10px","margin-left":"0","margin-right":"0"},attrs:{gutter:10}},[e("div",{staticStyle:{width:"300px",float:"left"}},[e("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),"sapp_Mod"==t.name?e("div",{staticClass:"el-icon-info",staticStyle:{"margin-left":"100px",float:"left"}},[e("span",{staticStyle:{color:"red"}},[t._v("注：")]),t._v("高级规则有用插件函数、且插件有变化，需要重启整个集群，使其生效")]):t._e(),e("div",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("添加")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleSave}},[t._v("保存")])],1)]),e("el-row",{staticStyle:{margin:"20px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticStyle:{"margin-right":"20px"}},[t._v("模块开关:")]),e("el-radio-group",{on:{change:t.setbaseState},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[e("el-radio",{attrs:{label:"on"}}),e("el-radio",{attrs:{label:"off"}})],1)],1),e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{float:"right"}},[e("span",{staticStyle:{"margin-right":"20px"}},[t._v("版本号："),e("span",{staticStyle:{color:"rgba(255, 141, 26, 1)"}},[t._v(t._s(t.version))])]),e("span",[t._v("数量："),e("span",{staticStyle:{color:"rgba(255, 141, 26, 1)"}},[t._v(t._s(t.count))])])])])],1),e("el-table",{attrs:{data:t.userList,border:""}},[e("el-table-column",{attrs:{label:"ID",align:"center",prop:"id","min-width":"5%"}}),e("el-table-column",{attrs:{label:"JSON数据",align:"left",prop:"contents","min-width":"60%"}}),e("el-table-column",{attrs:{label:"操作",align:"center","min-width":"30%","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{staticStyle:{color:"orange"},attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.handleSet(a.row)}}},[t._v("修改")]),e("el-button",{staticStyle:{color:"green"},attrs:{size:"mini",type:"text",icon:"el-icon-top"},on:{click:function(e){return t.up(a.$index)}}},[t._v("上移")]),e("el-button",{staticStyle:{color:"green"},attrs:{size:"mini",type:"text",icon:"el-icon-bottom"},on:{click:function(e){return t.down(a.$index)}}},[t._v("下移")]),e("el-button",{staticStyle:{color:"green"},attrs:{size:"mini",type:"text",icon:"el-icon-arrow-up"},on:{click:function(e){return t.upIndex(a.$index)}}},[t._v("置顶")]),e("el-button",{staticStyle:{color:"green"},attrs:{size:"mini",type:"text",icon:"el-icon-arrow-down"},on:{click:function(e){return t.downIndex(a.$index)}}},[t._v("置底")]),e("el-popover",{attrs:{placement:"top",width:"160"},model:{value:a.row.visible,callback:function(e){t.$set(a.row,"visible",e)},expression:"scope.row.visible"}},[e("p",[t._v("确定要删除吗?")]),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){a.row.visible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleDel(a.row)}}},[t._v("确定")])],1),e("el-button",{staticStyle:{color:"red","margin-right":"5px"},attrs:{slot:"reference",size:"mini",type:"text",icon:"el-icon-delete"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),e("el-row",[e("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleApply}},[t._v("应用")])],1)])],1)},N=[],J=(a("3c65"),a("5919"),{props:["name"],data(){return{count:0,state:"",version:"",userList:[],search:"",tempList:[]}},mounted(){this.getList()},methods:{setbaseState(){var t={G_version:this.version,state:this.state},e={action:"set",mod:"sbase",id:this.name,value:JSON.stringify(t)};Object(v["b"])(e).then(t=>{"ok"===t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})},up(t){0!==t&&this.swapItems(this.userList,t,t-1)},upIndex(t){0!==t&&this.swapItems(this.userList,t,0,"up")},down(t){t!==this.userList.length-1&&this.swapItems(this.userList,t,t+1)},downIndex(t){t!==this.userList.length-1&&this.swapItems(this.userList,t,0,"down")},swapItems(t,e,a,o){return"up"==o?(t.unshift(t[e]),t.splice(e+1,1),t):"down"==o?(t.push(t[e]),t.splice(e,1),t):(t[e]=t.splice(a,1,t[e])[0],t)},getList(){var t={action:"get",mod:this.name};Object(b["c"])(t).then(t=>{var e=t.msg,a=[];for(var o in e)if("count"!=o&&"G_version"!=o&&"state"!=o){var i={};i.id=o,i.contents=JSON.stringify(e[o]),a.push(i)}this.userList=a,this.tempList=a,this.count=e.count,this.version=e.G_version,this.state=e.state})},handleAdd(t){this.$emit("handleAdd",t)},handleSet(t){this.$emit("handleSet",t)},handleDel(t){var e={action:"del",mod:this.name,id:t.id};Object(b["f"])(e).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList()):this.$notify({title:"警告",message:t.msg,type:"warning"})})},handleSave(){var t={action:"save",mod:"all_Mod"};Object(v["h"])(t).then(t=>{"ok"==t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})},handleApply(){var t=this.userList.map(t=>JSON.parse(t.contents)),e={action:"set",mod:this.name,value:JSON.stringify(t)};Object(b["f"])(e).then(t=>{"ok"==t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})}},watch:{search:{handler:function(t,e){this.userList=""===t?this.tempList:this.tempList.filter((function(e){if(e.contents.indexOf(t)>=0)return!0}))}}}}),C=J,I=(a("50cd"),Object(h["a"])(C,L,N,!1,null,"7af29343",null)),M=I.exports,P={components:{AdvJsonGui:z,Adv:M},data(){return{open:!1,title:"",form:{contents:{}}}},methods:{editConfirm(t){const e={action:t.action,mod:"sapp_Mod",value:JSON.stringify(t.form.contents)};"set"===t.action&&(e["id"]=t.form["id"]),Object(b["f"])(e).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.$refs.advanced.getList(1)):this.$notify({title:"警告",message:t.msg,type:"warning"})})},reset(){this.form={contents:{state:"on"}}},cancel(){this.open=!1,this.reset()},handleAdd(){this.reset(),this.title="添加",this.open=!0},handleSet(t){this.reset(),this.title="修改";var e={};e.id=t.id,e.contents=JSON.parse(t.contents),this.form=e,this.open=!0}}},G=P,V=(a("5353"),Object(h["a"])(G,j,O,!1,null,"a6a3b4c6",null)),E=V.exports,q=function(){var t=this,e=t._self._c;return e("div",[e("Adv",{ref:"node",attrs:{name:"snetwork_Mod"},on:{handleSet:t.handleSet,handleAdd:t.handleAdd}}),e("freq-json-gui",{attrs:{visibleProp:t.open,title:t.title,formData:t.form,width:"60%"},on:{hideDialog:t.cancel,asyncEditConfirm:t.editConfirm}})],1)},B=[],U=function(){var t=this,e=t._self._c;return e("el-dialog",t._g(t._b({attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:t.open,title:t.title,width:"80%"},on:{"update:visible":function(e){t.open=e},close:t.cancel}},"el-dialog",t.$attrs,!1),t.$listeners),[e("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"图形化配置",name:"gui"}},[e("el-form",{ref:"editform",attrs:{model:t.guiFormData,"label-width":"80px"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"规则Id"}},[e("el-input",{attrs:{placeholder:"输入id信息"},model:{value:t.guiFormData.id,callback:function(e){t.$set(t.guiFormData,"id",e)},expression:"guiFormData.id"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"描述信息"}},[e("el-input",{attrs:{placeholder:"输入描述信息"},model:{value:t.guiFormData.des,callback:function(e){t.$set(t.guiFormData,"des",e)},expression:"guiFormData.des"}})],1)],1)],1),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"是否启用"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:t.switchChange},model:{value:t.guiFormData["switch"],callback:function(e){t.$set(t.guiFormData,"switch",t._n(e))},expression:"guiFormData['switch']"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"WAF标识"}},[e("el-input",{attrs:{placeholder:"输入tag"},model:{value:t.guiFormData.waf,callback:function(e){t.$set(t.guiFormData,"waf",e)},expression:"guiFormData.waf"}})],1)],1)],1),e("el-row",[e("el-form-item",{attrs:{label:"匹配规则"}},[e("adv",{ref:"adv",attrs:{ruleData:t.ruleData,tableDataProps:t.matchRulesData}})],1)],1),e("el-row",[e("el-form-item",{attrs:{label:"频率规则"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{label:"匹配位置",width:"80"}},[t._v("ip")]),e("el-table-column",{attrs:{label:"时间窗口（单位:s）",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{placeholder:"输入时间",size:"small"},model:{value:a.row["blackTime"],callback:function(e){t.$set(a.row,"blackTime",t._n("string"===typeof e?e.trim():e))},expression:"scope.row['blackTime']"}})]}}])}),e("el-table-column",{attrs:{label:"请求次数",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{placeholder:"输入次数",size:"small"},model:{value:a.row["maxReqs"],callback:function(e){t.$set(a.row,"maxReqs",t._n("string"===typeof e?e.trim():e))},expression:"scope.row['maxReqs']"}})]}}])}),e("el-table-column",{attrs:{label:"拦截时长（单位:s）"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{placeholder:"输入拦截时间",size:"small"},model:{value:a.row["pTime"],callback:function(e){t.$set(a.row,"pTime",t._n(e))},expression:"scope.row['pTime']"}})]}}])})],1)],1)],1)],1)],1),e("el-tab-pane",{attrs:{label:"原始json配置",name:"originalJson"}},["originalJson"==t.activeTab?e("json-dialog",{ref:"jsonDialog",attrs:{contentsProp:t.form.contents,codeProp:t.code,width:"60%"}}):t._e()],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)},K=[],W={components:{JsonDialog:c["a"],Adv:S["a"]},props:{visibleProp:{type:Boolean,default:!1},title:{type:String,default:"添加"},formData:{type:Object}},data(){return{code:'\n\n\n{\n    "state": "on",\n    "id": "sapp_Mod-1000",\n    "des": "test-js_debug",\n    "waf": "nil/owasp标识",\n    "server_port": ["匹配内容", "匹配标识", "是否取反"],\n    "ip": ["匹配内容", "匹配标识", "是否取反"],\n    "network":{\n      "blackTime":120,\n      "maxReqs":500,\n      "pTime":10\n    }\n\n}\n\n\n',open:this.visibleProp,activeTab:"gui",form:this.formData,tableData:[{}],guiFormData:{id:"",switch:1,des:"",waf:"",server_port:[]},ruleData:{nameMatch:["server_port"],rule:["server_port",[["5566","9898"],"list",!1]]},matchRulesData:[]}},watch:{visibleProp(t){this.open=t},formData(t){this.form=t,this.jsonToGui()}},methods:{isJSON(t){if("string"==typeof t)try{var e=JSON.parse(t);return!("object"!=typeof e||!e)}catch(a){return!1}else if("object"==typeof t&&t)return!0},handleTabClick(t){"originalJson"===t.name?this.guiToJson():"gui"===t.name&&(this.form.contents=this.$refs.jsonDialog.contents,this.jsonToGui())},jsonToGui(){this.guiFormData=d()(this.form.contents),this.guiFormData.switch="on"===this.guiFormData.state?1:0,this.guiFormData["server_port"]=this.guiFormData["server_port"]||["",null,!1],this.$set(this.tableData,0,this.guiFormData.network||{}),this.matchRulesData=[];for(let t in this.guiFormData)if(-1!==T["a"].indexOf(t)){let e={dataTmpselectmatch:"",dataTmpselectwz:t,dataRuleValue:this.guiFormData[t][0],dataLocalruleData:{rule:[t,this.guiFormData[t]]}};this.matchRulesData.push(e)}},guiToJson(){const t=this.$refs.adv;t.tableData.forEach(t=>{this.$set(this.guiFormData,t.dataTmpselectwz,t.dataLocalruleData.rule)}),this.guiFormData.state=this.guiFormData.switch?"on":"off",this.guiFormData["server_port"]&&(this.guiFormData.server_port=this.guiFormData.server_port[1]||["","",!1]);const{maxReqs:e,pTime:a,blackTime:o}=this.tableData[0];this.guiFormData["network"]={maxReqs:1*e,pTime:1*a,blackTime:1*o},delete this.guiFormData.switch,this.form.contents=d()(this.guiFormData)},cancel(){this.$emit("hideDialog"),this.reset()},reset(){this.form={contents:{}}},submitForm(){if("gui"===this.activeTab)return void this.submitGui();const t=d()(this.$refs.jsonDialog.contents);if(!this.isJSON(t))return this.$message.error("配置内容:json格式错误/没有内容"),!1;if("编辑"===this.title){var e={action:"set",form:{...this.form,contents:t}};this.$emit("asyncEditConfirm",e)}else{var a={action:"add",form:this.form,contents:t};this.$emit("asyncEditConfirm",a)}},switchChange(){this.$forceUpdate()},submitGui(){this.guiToJson(),this.$emit("asyncEditConfirm",{action:"编辑"===this.title?"set":"add",form:this.form})}}},X=W,H=Object(h["a"])(X,U,K,!1,null,null,null),Q=H.exports,Y={components:{FreqJsonGui:Q,Adv:M},data(){return{open:!1,title:"",form:{id:0,contents:{}}}},methods:{editConfirm(t){t={action:t.action,mod:"snetwork_Mod",id:t.form.id,value:JSON.stringify(t.form.contents)},Object(b["f"])(t).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.$refs.node.getList(1)):this.$notify({title:"警告",message:t.msg,type:"warning"})})},reset(){this.form={id:0,contents:{state:"on"}}},cancel(){this.open=!1,this.reset()},handleAdd(){this.reset(),this.title="添加",this.open=!0},handleSet(t){this.reset(),this.title="编辑";var e={};e.id=t.id,e.contents=JSON.parse(t.contents),this.form=e,this.open=!0}}},Z=Y,tt=(a("b0db"),Object(h["a"])(Z,q,B,!1,null,"7f3721e7",null)),et=tt.exports,at={components:{Ipbwlist:_,Advancedrule:E,Frequencyrule:et},data(){return{tabindex:0}},methods:{handleClick(t){this.tabindex=t.index}}},ot=at,it=Object(h["a"])(ot,o,i,!1,null,"72292fa4",null);e["default"]=it.exports},"50cd":function(t,e,a){"use strict";a("80be")},5353:function(t,e,a){"use strict";a("e328")},5919:function(t,e,a){"use strict";a.d(e,"h",(function(){return n})),a.d(e,"c",(function(){return l})),a.d(e,"f",(function(){return c})),a.d(e,"g",(function(){return u})),a.d(e,"i",(function(){return d})),a.d(e,"a",(function(){return m})),a.d(e,"d",(function(){return p})),a.d(e,"j",(function(){return h})),a.d(e,"b",(function(){return f})),a.d(e,"e",(function(){return g}));var o=a("b775"),i=a("4328"),r=a.n(i),s=a("365c");function n(t){return Object(o["a"])({url:""+s["a"].domain.getDomain,method:"post",data:r.a.stringify(t)})}function l(t){return Object(o["a"])({url:""+s["a"].domain.defenseDomain,method:"post",data:r.a.stringify(t)})}function c(t){return Object(o["a"])({url:""+s["a"].domain.getCertification,method:"post",data:r.a.stringify(t)})}function u(){return Object(o["a"])({url:""+s["a"].domain.getCertification,method:"post"})}function d(t){return Object(o["a"])({url:""+s["a"].domain.setCertification,method:"post",data:r.a.stringify(t)})}function m(t){return Object(o["a"])({url:""+s["a"].domain.addCertification,method:"post",data:r.a.stringify(t)})}function p(t){return Object(o["a"])({url:""+s["a"].domain.delCertification,method:"post",data:r.a.stringify(t)})}function h(t){return Object(o["a"])({url:""+s["a"].domain.setDomain,method:"post",data:r.a.stringify(t)})}function f(t){return Object(o["a"])({url:""+s["a"].domain.addDomain,method:"post",data:r.a.stringify(t)})}function g(t){return Object(o["a"])({url:""+s["a"].domain.delDomain,method:"post",data:r.a.stringify(t)})}},"6ae5":function(t,e,a){"use strict";a.d(e,"i",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"g",(function(){return s})),a.d(e,"h",(function(){return n})),a.d(e,"j",(function(){return l})),a.d(e,"b",(function(){return u})),a.d(e,"c",(function(){return m})),a.d(e,"d",(function(){return p})),a.d(e,"e",(function(){return h})),a.d(e,"f",(function(){return d}));var o=a("5c96");const i={scheme:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],uri:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],remoteIp:["等于","列表","字典","IP段"],server_port:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],ip:["等于","列表","字典","IP段"],serverIp:["等于","列表","字典","IP段"],http_host:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],server_name:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],host:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],method:["等于","列表","字典","正则"],referer:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],headers:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],headers_data:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],useragent:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],cookie:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],request_uri:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],query_string:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],http_content_type:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],args:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],args_data:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],posts:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],posts_data:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],posts_all:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"],post_form:["等于","包含","正则","字典","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"]},r=["hostname","scheme","uri","remoteIp","server_port","ip","serverIp","http_host","server_name","host","method","referer","useragent","cookie","request_uri","query_string","http_content_type","headers","headers_data","args","args_data","posts","posts_data","posts_all","post_form"],s=["字典","IP段","长度","列表","包含列表","aho 包含列表","前缀列表","前缀列表(不分大小写)","后缀列表","后缀列表(不分大小写)"];let n=new Object;n["等于"]={value:"=",des:"【字符串等于】 eg:'请输入字符串' * 表示匹配任意字符串"},n["包含"]={value:"in",des:"【字符串包含】 eg:'请输入字符串'"},n["正则"]={value:"jio",des:"【字符串正则 jio (ngx.re 参数修改使用 json 配置)】 eg:'请输入字符串'"},n["TOKEN"]={value:"@token@",des:"【服务端 token 验证】 eg:'请输入变量名称 ...'"},n["字典"]={value:"dict",des:"【等于对象中任一值】 eg:{'匹配':true,'字典中值为 true':true,'任意一个':true}"},n["IP段"]={value:"cidr",des:"【ip段 cidr 列表匹配】 eg:['匹配','cidr 列表中','任意一个']"},n["长度"]={value:"len",des:"【字符串长度匹配 min <= (*len) <= max 】 eg:['最小值','最大值']"},n["列表"]={value:"list",des:"【等于列表任一值】 eg:['匹配','数组中','任意一个']"},n["包含列表"]={value:"in_list",des:"【包含列表任一值】 eg:['包含匹配','列表中','任意一个']"},n["aho 包含列表"]={value:"aho",des:"【包含列表任一值（使用 aho 算法）】 eg:['包含匹配','列表中','任意一个']"},n["前缀列表"]={value:"start_list",des:"【前缀列表任一值】 eg:['前缀','列表中','任意一个(前缀匹配)']"},n["前缀列表(不分大小写)"]={value:"ustart_list",des:"【前缀列表任一值】 eg:['前缀','列表中','任意一个(前缀匹配)']"},n["后缀列表"]={value:"end_list",des:"【后缀列表任一值】 eg:['后缀','列表中','任意一个(后缀匹配)']"},n["后缀列表(不分大小写)"]={value:"uend_list",des:"【后缀列表任一值】 eg:['后缀','列表中','任意一个(后缀匹配)']"};let l=new Object;l["header"]={value:"headers",des:"【header 取值配置】\r\neg:['header头名称(横线使用下划线代替)','匹配位置'] \r\neg:['X_Scan_Memo','any (当有多个同名 header 头时 匹配任意位置)'] \r\neg:['X_Scan_Memo','end (默认值 当有多个同名 header 头时 匹配最后一个)']"},l["args"]={value:"args",des:"【args 取值配置】\r\neg:['GET url请求参数名称','匹配位置'] \r\neg:['args_a','any (当有多个同名参数时 匹配任意位置)'] \r\neg:['args_b','end (默认值 当有多个同名 GET 参数时 匹配最后一个)']"},l["posts"]={value:"posts",des:"【posts 取值配置】\r\neg:['POST body请求参数名称','匹配位置'] \r\neg:['username','any (当有多个同名参数时 匹配任意位置)'] \r\neg:['password','end (默认值 当有多个同名参数时 匹配最后一个)']"},l["post_form"]={value:"post_form",des:"【post 表单取值配置】\r\neg:['form表单name名称',匹配位置(取值范围：1-4)] \r\neg:['*（匹配所有表单name）',2 -- 匹配文件名] \r\neg:['*（匹配所有表单name）',3 匹配上传文件类型]\r\neg:['*（匹配所有表单name）',4 匹配上传文件内容（前 10240 内容【可配置】）]\r\neg:['*（匹配所有表单name）',1 匹配form表单name名称]"};const c=a("833b");function u(t){return Object.prototype.toString.call(t)}function d(t){var e;if(Object.keys(n).forEach((function(a){n[a]["value"]==t[1]&&(e=n[a],e["name"]=a)})),null!=e)return"长度"==e.name?(o["Message"].error("数组 需要是 Number"),!1):"字典"==e.name?(o["Message"].error("内容 需要是 Object eg：{'aaaa':true,'bbbb':true}"),!1):"IP段"==e.name?(o["Message"].error("数组值需要是合法的 CIDR eg: '192.168.1.1'"),!1):s.includes(e.name)?(o["Message"].error("内容 需要是 Array eg：['1','aaaa']"),!1):void o["Message"].error("内容 需要是 String eg：'aaaa'")}function m(t){var e;if(""==t[1]&&(t[1]="="),"restart_list"==t[1]&&(t[1]="ustart_list"),"reend_list"==t[1]&&(t[1]="uend_list"),"rein_list"==t[1]&&(t[1]="uin_list"),"[object Boolean]"!=u(t[2])&&(t[2]=!1),Object.keys(n).forEach((function(a){n[a]["value"]==t[1]&&(e=n[a],e["name"]=a)})),null!=e){if("长度"==e.name){if(2!=t[0].length)return console.log("checkmatch(objmatch) 数组长度需要为 2"),o["Message"].error("数组长度需要为 2"),!1;if("[object Number]"!=u(t[0][0])||"[object Number]"!=u(t[0][1]))return console.log("checkmatch(objmatch) 数组 需要是 Number"),o["Message"].error("数组 需要是 Number"),!1}else if("字典"==e.name){if("[object Object]"!=u(t[0]))return console.log("checkmatch(objmatch) 内容 需要是 Object eg：{'aaaa':true,'bbbb':true}"),o["Message"].error("内容 需要是 Object eg：{'aaaa':true,'bbbb':true}"),!1;Object.keys(t[0]).forEach((function(e){if("[object Boolean]"!=u(t[0][e]))return console.log("checkmatch(objmatch) key 对应的值 需要是 Boolean eg: {'aaaa':true,'bbbb':true}"),o["Message"].error("key 对应的值 需要是 Boolean eg: {'aaaa':true,'bbbb':true}"),!1}))}else if("IP段"==e.name){if("[object Array]"!=u(t[0]))return!1;t[0]=Array.from(new Set(t[0])),console.log("objmatch[0] ",t[0]);for(var a=0;a<t[0].length;a++)if(!c.isValidAddress(t[0][a]))return console.log("checkmatch(objmatch) 数组值需要是合法的 CIDR eg: '192.168.1.1'"),o["Message"].error("数组值需要是合法的 CIDR eg: '192.168.1.1'"),!1}else if(s.includes(e.name)){if(console.log("列表111",u(t[0])),"[object Array]"!=u(t[0]))return console.log("checkmatch(objmatch) 内容 需要是 Array eg：['1','aaaa']"),o["Message"].error("内容 需要是 Array eg：['1','aaaa']"),!1;t[0]=Array.from(new Set(t[0]))}else if("[object String]"!=u(t[0]))return console.log("checkmatch(objmatch) 内容 需要是 String eg：'aaaa'"),o["Message"].error("内容 需要是 String eg：'aaaa'"),!1;return!0}var i=new RegExp("[^jiosadxDjuU]");return!i.test(t[1])&&(n["正则"]["value"]=t[1],!0)}function p(t){if(t.length>2)return console.log("匹配位置配置数组长度 <= 2 "),!1;if(null!=t[1]){let e=["any","end"];if(!e.includes(t[1])&&"[object Number]"!=u(t[1]))return console.log("位置错误 eg: any|end|null|%Number%"),!1}return!0}function h(t){return 2!=t.length?(console.log("匹配位置配置数组长度 == 2 eg:['*',2]"),!1):"[object Number]"!=u(t[1])?(console.log("位置错误 eg:1|2|3|4(Number)"),!1):!(t[1]>4||t[1]<1)||(console.log("位置错误 eg: 1<= N <= 4"),!1)}},"80be":function(t,e,a){},"92ab":function(t,e,a){"use strict";a("09ee")},"9f28":function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{label:"匹配位置",width:"260"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-select",{attrs:{size:"small",placeholder:"请选择",disabled:!!a.row["dataTmpselectwz"]},on:{change:function(e){return t.selectNodewz(a.row)}},model:{value:a.row["dataTmpselectwz"],callback:function(e){t.$set(a.row,"dataTmpselectwz","string"===typeof e?e.trim():e)},expression:"scope.row['dataTmpselectwz']"}},t._l(t.computedNameMatch,(function(a,o){return e("el-option",{key:o,attrs:{value:a}},[t._v(" "+t._s(a)+" ")])})),1),e("div",{directives:[{name:"show",rawName:"v-show",value:a.row["computedRulewz"],expression:"scope.row['computedRulewz']"}],staticStyle:{"margin-top":"8px"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:a.row["computed_dataRulewz_place"],type:"text",name:"name",size:"small",title:a.row["computed_dataRulewz_place"]},on:{blur:function(e){return e.preventDefault(),t.change_dataRulewz(a.row)}},model:{value:a.row["dataRulewz"],callback:function(e){t.$set(a.row,"dataRulewz","string"===typeof e?e.trim():e)},expression:"scope.row['dataRulewz']"}}),t._v(" * 匹配位置取值配置 ")],1)]}}])}),e("el-table-column",{attrs:{label:"匹配方式|取反标识",width:"400"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-select",{attrs:{size:"small",placeholder:"请选择"},on:{change:function(e){return t.selectNodematch(a.row)}},model:{value:a.row["dataTmpselectmatch"],callback:function(e){t.$set(a.row,"dataTmpselectmatch","string"===typeof e?e.trim():e)},expression:"scope.row['dataTmpselectmatch']"}},t._l(t.computedOptions[a.row["dataTmpselectwz"]],(function(a,o){return e("el-option",{key:o,attrs:{value:a}},[t._v(" "+t._s(a)+" ")])})),1),e("el-divider",{attrs:{direction:"vertical"}}),e("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},on:{change:e=>t.selectNodematchqf(e,a.row)},model:{value:a.row["dataIsNot"],callback:function(e){t.$set(a.row,"dataIsNot","string"===typeof e?e.trim():e)},expression:"scope.row['dataIsNot']"}},t._l(["false","true"],(function(a,o){return e("el-option",{key:o,attrs:{value:a}},[t._v(" "+t._s(a)+" ")])})),1)]}}])}),e("el-table-column",{attrs:{label:"匹配内容"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{placeholder:a.row["computed_dataRuleValue_place"]||t.computed_dataRuleValue_place(a.row.dataTmpselectmatch),size:"small",type:"text",name:"name",title:a.row["computed_dataRuleValue_place"]||t.computed_dataRuleValue_place(a.row.dataTmpselectmatch)},on:{input:function(e){return t.print(e)},blur:function(e){return e.preventDefault(),t.change_dataRuleValue(a.row)}},model:{value:a.row["dataRuleValue"],callback:function(e){t.$set(a.row,"dataRuleValue","string"===typeof e?e.trim():e)},expression:"scope.row['dataRuleValue']"}})]}}])})],1)],1)},i=[],r=(a("14d9"),a("6ae5")),s=a("2ef0"),n=a.n(s),l={name:"match",props:{ruleData:{type:Object,required:!1,default:function(){return{nameMatch:[],rule:["referer",["https://www.baidu.com\\.*","jo"],"and"]}},validator:function(t){var e=JSON.parse(JSON.stringify(t));if(0==e.rule.length)return!0;if("headers"==e.rule[0]||"args"==e.rule[0]||"posts"==e.rule[0]){if(!Object(r["d"])(e.rule[1][2]))return console.log("valueObj.rule[1][2] 匹配位置配置不合法！"),!1;let t=[e.rule[1][0],e.rule[1][1]];if(console.log(t),!Object(r["c"])(t))return console.log("valueObj.rule[1][0-1]  二阶规则不合法！"),!1}else if("post_form"==e.nameMatch[0]){if(!Object(r["e"])(e.rule[1][2]))return console.log("valueObj.rule[1][2] 匹配位置配置不合法！"),!1;let t=[e.rule[1][0],e.rule[1][1]];if(!Object(r["c"])(t))return console.log("valueObj.rule[1][0-1]  二阶规则不合法！"),!1}else if(!Object(r["c"])(e.rule[1]))return console.log(e.rule[1]),console.log("valueObj.rule[1] 二阶规则不合法！"),!1;return!0}},tableDataProps:{type:Array,required:!1,default:()=>[]}},computed:{computedNameMatch(){let t=[];if(0==this.ruleData.nameMatch.length)return console.log(88),t=[].concat(r["a"]),t;for(var e=this.ruleData.nameMatch.length-1;e>=0;e--)r["a"].includes(this.ruleData.nameMatch[e])&&t.push(this.ruleData.nameMatch[e]);return 0==t.length?(t=[].concat(r["a"]),console.log("NameMatchList is ",t),t):t},computedOptions(){return r["i"]}},watch:{tableDataProps(t){void 0!=t&&(this.tableData=n.a.cloneDeep(t)||[],this.tableData.forEach(t=>{this.initData(t)}))}},data(){return{tableData:[{},{}]}},mounted(){this.tableData=n.a.cloneDeep(this.tableDataProps),this.tableData.forEach(t=>{this.initData(t)})},methods:{handleCheckclear(){},selectALl(t){t["dataLocalruleData"]?t["dataLocalruleData"].rule[0]=t.dataTmpselectwz:t["dataLocalruleData"]={rule:[t.dataTmpselectwz]},null!=r["h"][t.dataTmpselectmatch]&&(t.dataRuleArray[1]=r["h"][t.dataTmpselectmatch].value),""!=t.dataRuleValue&&this.check_dataRuleValue(t),t.computedRulewz?(t.dataRuleArray[2]="true"==t.dataIsNot,t.dataLocalruleData.rule[1][0]=t.dataRuleArray[0],t.dataLocalruleData.rule[1][1]=t.dataRuleArray[1],t.dataLocalruleData.rule[1][3]=t.dataRuleArray[2],""!=t.dataRulewz&&this.check_dataRulewz(t)):(t.dataRuleArray[2]="true"==t.dataIsNot,t.dataLocalruleData.rule[1]=t.dataRuleArray),console.log(t),t.dataLocalruleData.rule[2]=t.dataOperator,t.dataRuleView=JSON.stringify(t.dataLocalruleData.rule),this.$forceUpdate()},selectNodewz(t){t["computedRulewz"]=this.computedRulewz(t.dataTmpselectwz),t["computed_dataRulewz_place"]=this.computed_dataRulewz_place(t.dataTmpselectwz),this.selectALl(t),console.log("匹配位置:",t.dataTmpselectwz)},computedRulewz(t){let e=["headers","args","posts","post_form"];return!!e.includes(t)},computed_dataRulewz_place(t){var e=r["j"][t];return null!=e?e.des:""},selectNodematch(t){this.selectALl(t),t["computed_dataRuleValue_place"]=this.computed_dataRuleValue_place(t.dataTmpselectmatch),console.log("匹配方式:",t.dataTmpselectmatch)},computed_dataRuleValue_place(t){var e=r["h"][t];return null!=e?e.des:""},selectNodematchqf(t,e){this.selectALl(e),console.log("是否取反:",e.dataIsNot)},print(t){console.log(t)},selectNodeOperator(t){this.$forceUpdate(),this.selectALl(t),console.log("规则连接运算符:",t.dataOperator)},check_dataRuleValue(t){if(t["dataTmpselectmatch"]&&r["g"].includes(t.dataTmpselectmatch))try{var e=JSON.parse(t.dataRuleValue);t.dataRuleArray[0]=e,Object(r["c"])(t.dataRuleArray)&&console.log("dataRuleValue 规则合法",t.dataRuleArray)}catch(a){return console.log("dataRuleValue 规则不合法合法",a),Object(r["f"])(t.dataRuleArray),!1}else{if(!t["dataRuleArray"])return void(t["dataRuleArray"]=[t["dataRuleValue"]]);t.dataRuleArray[0]=t.dataRuleValue}return!0},change_dataRuleValue(t){this.selectALl(t)},check_dataRulewz(t){try{if("headers"==t.dataTmpselectwz){t.dataRulewz=t.dataRulewz.replace(/-/g,"_");let e=JSON.parse(t.dataRulewz);if(t.dataLocalruleData.rule[1][2]=e,!Object(r["d"])(e))return console.log(t.dataTmpselectwz,"匹配位置配置 规则不合法"),!1;console.log(t.dataTmpselectwz,"匹配位置配置 规则合法")}else{if("post_form"==t.dataTmpselectwz){let e=JSON.parse(t.dataRulewz);return t.dataLocalruleData.rule[1][2]=e,Object(r["e"])(e)?(console.log(t.dataTmpselectwz,"匹配位置配置 规则合法"),!1):(console.log(t.dataTmpselectwz,"匹配位置配置 规则不合法"),!1)}{let e=JSON.parse(t.dataRulewz);if(t.dataLocalruleData.rule[1][2]=e,!Object(r["d"])(e))return console.log(t.dataTmpselectwz,"匹配位置配置 规则不合法"),!1;console.log(t.dataTmpselectwz,"匹配位置配置 规则合法")}}}catch(e){return console.log("匹配位置配置 规则不合法",e),!1}return!0},change_dataRulewz(t){this.selectALl(t)},initData(t){if(t["dataLocalruleData"]&&0!=t["dataLocalruleData"]["rule"].length){console.log(2);const o=t.dataLocalruleData.rule[0];this.computedRulewz(o)?("[object Boolean]"!=Object(r["b"])(t.dataLocalruleData.rule[1][3])&&(t.dataLocalruleData.rule[1][3]=!1),t.dataRuleArray=[t.dataLocalruleData.rule[1][0],t.dataLocalruleData.rule[1][1],t.dataLocalruleData.rule[1][3]],t.dataRulewz=JSON.stringify(t.dataLocalruleData.rule[1][2])):("[object Boolean]"!=Object(r["b"])(t.dataLocalruleData.rule[1][2])&&(t.dataLocalruleData.rule[1][2]=!1),t.dataRuleArray=t.dataLocalruleData.rule[1]),Object(r["c"])(t.dataRuleArray);let i=t.dataRuleArray[1];var e;if(Object.keys(r["h"]).forEach((function(t){r["h"][t]["value"]==i&&(e=r["h"][t],e["name"]=t)})),null!=e)t.dataTmpselectmatch=e.name;else{var a=new RegExp("[^jiosadxDjuU]");a.test(i)||(t.dataTmpselectmatch="正则")}"[object String]"!=Object(r["b"])(t.dataRuleArray[0])?t.dataRuleValue=JSON.stringify(t.dataLocalruleData.rule[1][0]):t.dataRuleValue=t.dataLocalruleData.rule[1][0],this.$set(t,"dataIsNot",t.dataRuleArray[2].toString())}else{const e=this.computedNameMatch[0],a=r["i"][e][0],o=[e,["",r["h"][a]?r["h"][a]:"="],t["dataOperator"]||null];let i=[];console.log(e),this.computedRulewz(e)?(o[1][2]=[],o[1][3]=t["dataIsNot"],i=[o[1][0],o[1][2],o[1][3]]):(o[1][2]=t["dataIsNot"],i=o[1]),console.log(i);const s={dataTmpselectwz:e,dataTmpselectmatch:a,dataLocalruleData:{rule:[...o]},dataRuleArray:[...i]};t={...t,...s},console.log(t)}this.$set(t,"dataOperator",t.dataLocalruleData.rule[2]),t["dataRuleView"]=JSON.stringify(t.dataLocalruleData.rule)}}},c=l,u=a("2877"),d=Object(u["a"])(c,o,i,!1,null,"1fb2e4a2",null);e["a"]=d.exports},b0db:function(t,e,a){"use strict";a("17d0")},d358:function(t,e,a){"use strict";a("05b5")},d44e:function(t,e,a){var o=a("9bf2").f,i=a("1a2d"),r=a("b622"),s=r("toStringTag");t.exports=function(t,e,a){t&&!a&&(t=t.prototype),t&&!i(t,s)&&o(t,s,{configurable:!0,value:e})}},e328:function(t,e,a){},f8c9:function(t,e,a){var o=a("23e7"),i=a("da84"),r=a("d44e");o({global:!0},{Reflect:{}}),r(i.Reflect,"Reflect",!0)}}]);