(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-731eb696"],{"1fbe":function(t,e,r){"use strict";r.d(e,"e",(function(){return n})),r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return c})),r.d(e,"h",(function(){return m})),r.d(e,"d",(function(){return p})),r.d(e,"g",(function(){return u})),r.d(e,"c",(function(){return f})),r.d(e,"f",(function(){return d}));var i=r("b775"),s=r("4328"),o=r.n(s),a=r("365c");function n(t){return Object(i["a"])({url:""+a["a"].fourtier.getStream,method:"get",params:t})}function l(t){return Object(i["a"])({url:""+a["a"].fourtier.addStream,method:"post",data:o.a.stringify(t)})}function c(t){return Object(i["a"])({url:""+a["a"].fourtier.delStream,method:"post",data:o.a.stringify(t)})}function m(t){return Object(i["a"])({url:""+a["a"].fourtier.setStream,method:"post",data:o.a.stringify(t)})}function p(t){return Object(i["a"])({url:""+a["a"].fourtier.getSip,method:"get",params:t})}function u(t){return Object(i["a"])({url:""+a["a"].fourtier.setSip,method:"post",data:o.a.stringify(t)})}function f(t){return Object(i["a"])({url:""+a["a"].fourtier.configDict,method:"get",params:t})}function d(t){return Object(i["a"])({url:""+a["a"].fourtier.configDict,method:"post",data:o.a.stringify(t)})}},4989:function(t,e,r){"use strict";r("c181")},"92aa":function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("el-card",{attrs:{shadow:"never"}},[e("el-row",{staticStyle:{"margin-bottom":"10px","margin-left":"10px","margin-right":"10px"},attrs:{gutter:10}},[e("div",{staticStyle:{width:"300px",float:"left"}},[e("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e("div",{staticClass:"el-icon-info",staticStyle:{"margin-left":"100px",float:"left"}},[e("span",{staticStyle:{color:"red"}},[t._v("注：")]),t._v("4层转发配置有变更时，需要重启整个集群，使其生效")]),e("div",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("添加")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleSave}},[t._v("保存")])],1)]),e("el-table",{attrs:{data:t.streamList,border:""}},[e("el-table-column",{attrs:{label:"stream名称",align:"center",prop:"stream_name","min-width":"12%","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"描述",align:"left",prop:"des","min-width":"15%","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"diff_file",align:"left",prop:"diff_file","min-width":"8%","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"内容",align:"left",prop:"contents","min-width":"53%","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"操作",align:"center","min-width":"12%","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("el-button",{staticStyle:{color:"rgba(24, 144, 255, 1)"},attrs:{type:"text"},on:{click:function(e){return t.handleSet(r.row)}}},[t._v("编辑")]),e("el-popover",{attrs:{placement:"top",width:"160"},model:{value:r.row.visible,callback:function(e){t.$set(r.row,"visible",e)},expression:"scope.row.visible"}},[e("p",[t._v("确定要删除吗?")]),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){r.row.visible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleDel(r.row)}}},[t._v("确定")])],1),e("el-button",{staticStyle:{color:"rgba(212, 48, 48, 1)","margin-left":"10px"},attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),e("el-dialog",{attrs:{title:t.title,visible:t.open,width:"60%"},on:{"update:visible":function(e){t.open=e}}},[e("el-tabs",{on:{"tab-click":this.tabClick},model:{value:t.activename,callback:function(e){t.activename=e},expression:"activename"}},[e("el-tab-pane",{attrs:{label:"基础",name:"基础"}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"190px"}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"stream名称:",prop:"stream_name"}},[e("el-input",{model:{value:t.form.stream_name,callback:function(e){t.$set(t.form,"stream_name",e)},expression:"form.stream_name"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{staticClass:"change-label-width",attrs:{label:"描述:",prop:"des"}},[e("el-input",{model:{value:t.form.des,callback:function(e){t.$set(t.form,"des",e)},expression:"form.des"}})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"端口:",prop:"port"}},[e("el-input",{model:{value:t.form.port,callback:function(e){t.$set(t.form,"port",t._n(e))},expression:"form.port"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{staticClass:"change-label-width",attrs:{label:"协议:",prop:"l_type"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"协议"},model:{value:t.form.l_type,callback:function(e){t.$set(t.form,"l_type",e)},expression:"form.l_type"}},t._l(t.agreeArray,(function(t){return e("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1)],1)],1)],1),e("el-form-item",{attrs:{label:"proxy_connect_timeout:",prop:"proxy_connect_timeout"}},[e("el-col",[e("el-input",{staticStyle:{width:"38%","margin-right":"5px"},model:{value:t.form.proxy_connect_timeout,callback:function(e){t.$set(t.form,"proxy_connect_timeout",e)},expression:"form.proxy_connect_timeout"}}),e("span",{staticStyle:{color:"red","margin-left":"20px"}},[t._v("* ")]),t._v("eg:5s 单位：秒 ")],1)],1),e("el-form-item",{attrs:{label:"proxy_timeout:",prop:"proxy_timeout"}},[e("el-col",[e("el-input",{staticStyle:{width:"38%","margin-right":"5px"},model:{value:t.form.proxy_timeout,callback:function(e){t.$set(t.form,"proxy_timeout",e)},expression:"form.proxy_timeout"}}),e("span",{staticStyle:{color:"red","margin-left":"20px"}},[t._v("* ")]),t._v("eg:30s 单位：秒 ")],1)],1),e("el-form-item",{attrs:{label:"源站:",prop:"ips"}},[e("el-col",[e("el-input",{attrs:{type:"textarea",rows:"6"},model:{value:t.form.ips,callback:function(e){t.$set(t.form,"ips",e)},expression:"form.ips"}}),e("span",{staticStyle:{color:"red","margin-left":"20px"}},[t._v("* ")]),t._v('eg: [{"fail_timeout":"10s","server":"192.168.28.26:1188","weight":2}...] ')],1)],1)],1)],1),"编辑"===t.title?e("el-tab-pane",{attrs:{label:"高级",name:"高级"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:24}},[e("codemirror",{ref:"codemirrorRef",staticClass:"editorR",attrs:{options:t.options},model:{value:t.form.ngx_file,callback:function(e){t.$set(t.form,"ngx_file",e)},expression:"form.ngx_file"}})],1)],1)],1):t._e()],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)],1)},s=[],o=(r("14d9"),r("8f94")),a=(r("a7be"),r("acdf"),r("7ba3"),r("a8d9"),r("db91"),r("b2b9"),r("f9d4"),r("8e77")),n=r("45a3"),l=r("1fbe"),c=r("a417");const m=r("e762").Base64;var p={components:{MarkdownPreview:a["a"],vueJsonEditor:n["a"],codemirror:o["codemirror"]},data(){return{code:'[{\n    "port": 1188,\n    "stream_name": "stream名称（唯一）[stream_1188]",\n    "l_type": "nil/udp/tcp",\n    "des": "描述 stream 1188 for grpc",\n    "proxy_connect_timeout": "5s",\n    "proxy_timeout": "30s",\n    "ips": [\n        {\n            "server": "192.168.28.26:1188",\n            "weight": 2,\n            "fail_timeout": "10s"\n        },\n        {\n            "server": "192.168.28.27:1188",\n            "max_fails": 3\n        },\n        {\n            "server": "192.168.28.28:1188",\n            "max_fails": 5,\n            "fail_timeout": "10s"\n        }\n    ]\n},\n...\n]',options:{tabSize:4,mode:{name:"javascript",json:!0},theme:"darcula",lineNumbers:!0,line:!0,lineWrapping:!0,styleSelectedText:!0,styleActiveLine:!0,hintOptions:{completeSingle:!0}},streamList:[],tempList:[],search:"",activename:"基础",open:!1,title:"",certs_key:[],form:{stream_name:"stream",des:"des",port:8080,l_type:"tcp",proxy_connect_timeout:"",proxy_timeout:"",ips:"",ngx_file:""},rules:{stream_name:[{required:!0,message:"stream名称不能为空",trigger:"blur"}],port:[{required:!0,message:"端口不能为空",trigger:"blur"},{type:"number",message:"端口必须为数字"}],proxy_connect_timeout:[{required:!0,message:"proxy_connect_timeout不能为空",trigger:"blur"}],proxy_timeout:[{required:!0,message:"proxy_timeout不能为空",trigger:"blur"}],ips:[{required:!0,message:"源站不能为空",trigger:"blur"}]},agreeArray:[{value:"tcp"},{value:"udp"}]}},created(){this.getList()},methods:{tabClick(t,e){"高级"===t.name&&this.$refs.codemirrorRef.refresh()},getList(){var t={stream_name:"all_stream"};Object(l["e"])(t).then(t=>{console.log(t);var e=t.msg,r=[];for(var i in e)r.push({...e[i],contents:JSON.stringify(e[i]),ips:JSON.stringify(e[i].ips)});this.streamList=r,this.tempList=r})},reset(){this.form={stream_name:"",des:"",port:0,l_type:"tcp",proxy_connect_timeout:"",proxy_timeout:"",ips:"",ngx_file:""}},cancel(){this.open=!1,this.reset()},checkisRewrite_https(){this.form.http.isRewrite_https&&(this.form.isOpenHttps=!0)},handleAdd(){this.reset(),this.title="添加",this.activename="基础",this.open=!0},handleSet(t){this.reset(),this.title="编辑",this.activename="基础",this.form=t,this.open=!0},handleDel(t){var e=[t.stream_name],r={stream_names:JSON.stringify(e)};Object(l["b"])(r).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList()):this.$notify({title:"警告",message:t.msg,type:"warning"})})},submitForm(){this.$refs["form"].validate(t=>{});var{stream_name:t,des:e,port:r,l_type:i,proxy_connect_timeout:s,proxy_timeout:o}=this.form,a={stream_name:t,des:e,port:r,l_type:i,proxy_connect_timeout:s,proxy_timeout:o,ips:JSON.parse(this.form.ips)};if("编辑"===this.title)if("基础"===this.activename){var n={value:JSON.stringify([{...a}])};Object(l["h"])(n).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList(1)):this.$notify({title:"警告",message:t.msg,type:"warning"})})}else{var c={value:JSON.stringify([{...a,ngx_file:this.form.ngx_file}])};Object(l["h"])(c).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList(1)):this.$notify({title:"警告",message:t.msg,type:"warning"})})}else{var m={value:JSON.stringify([{...a}])};Object(l["a"])(m).then(t=>{"ok"===t.code?(this.$notify({title:"成功",message:t.msg,type:"success"}),this.open=!1,this.getList(1)):this.$notify({title:"警告",message:t.msg,type:"warning"})})}},handleSave(){var t={action:"save",mod:"all_Mod"};Object(c["h"])(t).then(t=>{"ok"==t.code?this.$notify({title:"成功",message:t.msg,type:"success"}):this.$notify({title:"警告",message:t.msg,type:"warning"})})}},filters:{match:function(t){return m.decode(t)}},watch:{$route(t,e){},search:{handler:function(t,e){this.streamList=""===t?this.tempList:this.tempList.filter((function(e){if(e.contents.indexOf(t)>=0)return!0}))}}}},u=p,f=(r("4989"),r("2877")),d=Object(f["a"])(u,i,s,!1,null,"1f758a25",null);e["default"]=d.exports},c181:function(t,e,r){}}]);