(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f3df174"],{"1c31":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return o}));var i=a("b775"),s=(a("4328"),a("365c"));function r(t){return Object(i["a"])({url:""+s["a"].report.secGlobal,method:"get"})}function n(t){return Object(i["a"])({url:""+s["a"].report.secTrendx,method:"get",params:t})}function d(t){return Object(i["a"])({url:""+s["a"].report.secWafLog,method:"get",params:t})}function o(){return Object(i["a"])({url:""+s["a"].report.secOwasp,method:"get"})}},aa1d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-card",{staticStyle:{height:"560px"},attrs:{shadow:"never"}},[e("div",{staticStyle:{width:"100%",height:"560px"},attrs:{id:"reqPie"}})])],1),e("el-col",{attrs:{span:12}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.results_customRule}},[e("el-table-column",{staticStyle:{width:"50%"},attrs:{prop:"site",label:"请求域名"}}),e("el-table-column",{staticStyle:{width:"50%"},attrs:{prop:"total",label:"请求次数"}})],1),e("WafPage",{attrs:{pageSizes:t.pageSizes_customRule,pageSize:t.pageSize_customRule,pageTotal:t.pageTotal_customRule,currentPage:t.currentPage_customRule},on:{handleSizeChange:t.handleSizeChange_customRule,handleCurrentChange:t.handleCurrentChange_customRule}}),e("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.results_bandwidth}},[e("el-table-column",{staticStyle:{width:"50%"},attrs:{prop:"site",label:"请求域名"}}),e("el-table-column",{staticStyle:{width:"50%"},attrs:{prop:"total",label:"使用带宽(MB)"}})],1),e("WafPage",{attrs:{pageSizes:t.pageSizes_bandwidth,pageSize:t.pageSize_bandwidth,pageTotal:t.pageTotal_bandwidth,currentPage:t.currentPage_bandwidth},on:{handleSizeChange:t.handleSizeChange_bandwidth,handleCurrentChange:t.handleCurrentChange_bandwidth}})],1)],1),e("el-row",{staticClass:"custom-col",staticStyle:{"margin-bottom":"20px"}},[e("el-col",{attrs:{span:24}},[e("el-card",{attrs:{shadow:"never"}},[e("div",{staticStyle:{"line-height":"30px",height:"30px"},attrs:{slot:"header"},slot:"header"},[e("div",{staticStyle:{float:"left"}},[e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.initData(7,7,"draw3",t.sh)}}},[t._v("7天")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.initData(30,30,"draw3",t.sh)}}},[t._v("30天")])]),e("div",{staticStyle:{float:"left","margin-left":"20px"}},[e("div",[e("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh.date1,callback:function(e){t.$set(t.sh,"date1",e)},expression:"sh.date1"}}),t._v(" - "),e("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh.date2,callback:function(e){t.$set(t.sh,"date2",e)},expression:"sh.date2"}}),t._v("   "),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.initData(8,8,"draw3",t.sh)}}},[t._v("查询")])],1)]),e("div",{staticStyle:{float:"right"}},[t._v(" 最小刻度："),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.draw3("10m")}}},[t._v("10min")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.draw3("1h")}}},[t._v("1h")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.draw3("1d")}}},[t._v("1d")])])]),e("div",{staticStyle:{width:"100%",height:"480px"},attrs:{id:"wafTrend"}})])],1)],1),e("el-row",{staticClass:"custom-col"},[e("el-col",{attrs:{span:24}},[e("el-card",{attrs:{shadow:"never"}},[e("div",{staticStyle:{"line-height":"30px",height:"30px"},attrs:{slot:"header"},slot:"header"},[e("div",{staticStyle:{float:"left"}},[e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.initData(7,7,"draw2",t.sh2)}}},[t._v("7天")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.initData(30,30,"draw2",t.sh2)}}},[t._v("30天")])]),e("div",{staticStyle:{float:"left","margin-left":"20px"}},[e("div",[e("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh2.date1,callback:function(e){t.$set(t.sh2,"date1",e)},expression:"sh2.date1"}}),t._v(" - "),e("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh2.date2,callback:function(e){t.$set(t.sh2,"date2",e)},expression:"sh2.date2"}}),t._v("   "),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.initData(8,8,"draw2",t.sh2)}}},[t._v("查询")])],1)]),e("div",{staticStyle:{float:"right"}},[t._v(" 最小刻度："),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.draw2("10m")}}},[t._v("10min")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.draw2("1h")}}},[t._v("1h")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.draw2("1d")}}},[t._v("1d")])])]),e("div",{staticStyle:{width:"100%",height:"480px"},attrs:{id:"dayTrend"}})])],1)],1),e("el-row",{staticClass:"custom-col"},[e("el-col",{attrs:{span:24}},[e("el-card",{attrs:{shadow:"never"}},[e("div",{staticStyle:{"line-height":"30px",height:"30px"},attrs:{slot:"header"},slot:"header"},[e("div",{staticStyle:{float:"left"}},[e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.initData(7,7,"drawBandWidth",t.sh_bandwidth)}}},[t._v("7天")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.initData(30,30,"drawBandWidth",t.sh_bandwidth)}}},[t._v("30天")])]),e("div",{staticStyle:{float:"left","margin-left":"20px"}},[e("div",[e("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh_bandwidth.date1,callback:function(e){t.$set(t.sh_bandwidth,"date1",e)},expression:"sh_bandwidth.date1"}}),t._v(" - "),e("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.sh_bandwidth.date2,callback:function(e){t.$set(t.sh_bandwidth,"date2",e)},expression:"sh_bandwidth.date2"}}),t._v("   "),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.initData(8,8,"drawBandWidth",t.sh_bandwidth)}}},[t._v("查询")])],1)]),e("div",{staticStyle:{"margin-left":"20px, float:left"}},[e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.onDomainSelectChange},model:{value:t.domainSelect,callback:function(e){t.domainSelect=e},expression:"domainSelect"}},t._l(t.domainOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1),e("div",{staticStyle:{float:"right"}},[t._v(" 最小刻度："),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.drawBandWidth("10m")}}},[t._v("10min")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.drawBandWidth("1h")}}},[t._v("1h")]),t._v("   "),e("label",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255) !important"},on:{click:function(e){return t.drawBandWidth("1d")}}},[t._v("1d")])])],1)]),e("div",{staticStyle:{width:"100%",height:"480px"},attrs:{id:"bandWidthDayTrend"}})])],1)],1)],1)},s=[],r=(a("14d9"),a("1c31")),n=a("164e"),d=a.n(n);const o=()=>a.e("chunk-fc4ab3d6").then(a.bind(null,"0882")),l=()=>a.e("chunk-2d22c16d").then(a.bind(null,"f26a")),h={title:{text:""},tooltip:{trigger:"axis"},toolbox:{x:"80%",y:"top",show:!0,feature:{mark:{show:!0},saveAsImage:{show:!0},dataView:{show:!0}}},legend:{data:[]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:[{type:"value"}],series:[]};var c={data(){return{ruleSearch:"",temp:[],state:"on",count:0,data:[],gl_method:[],gl_method_title:[],option4:{color:["rgba(60, 144, 247, 1)","rgba(244, 205, 73, 1)","rgba(85, 191, 192, 1)","rgba(94, 190, 103, 1)","rgba(224, 86, 103, 1)","rgba(124, 75, 216, 1)"],tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",right:0,top:"50px",itemGap:20,icon:"circle",textStyle:{fontSize:10,fontFamily:"Monaco"},data:[],formatter:t=>{let e,a=0;return this.option4.series[0].data.forEach(i=>{a+=i.value,i.name==t&&(e=i.value)}),t.padEnd(18," ")+((100*e/a).toFixed(2)+"% ").padEnd(8)+e.toString().padStart(5)}},series:[{name:"访问方式",type:"pie",radius:"50%",center:["25%","30%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},labelLine:{normal:{show:!1},show:!1},label:{show:!1}}]},customRule:[],results_customRule:[],pageSizes_customRule:[5],pageSize_customRule:5,pageTotal_customRule:0,currentPage_customRule:1,bandwidthData:[],results_bandwidth:[],pageSizes_bandwidth:[5],pageSize_bandwidth:5,pageTotal_bandwidth:0,currentPage_bandwidth:1,sh:{date1:"",date2:""},waf_start_day:0,waf_end_day:0,waf_request:[],option:{title:{left:"left",text:"请求总量"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",boundaryGap:[0,"100%"]},dataZoom:[{type:"inside",start:0,end:10},{start:0,end:10,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{name:"模拟数据",type:"line",smooth:!0,symbol:"none",sampling:"average",itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new d.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])},data:[]}]},sh2:{date1:"",date2:""},waf_start_day2:0,waf_end_day2:0,site_request_Data:[],site_request_Data_BandWidth:[],option2:h,sh_bandwidth:{date1:"",date2:""},waf_start_day_bandwidth:0,waf_end_day_bandwidth:0,option2_bandwidth:h,domainOptions:[],domainSelect:""}},mounted(){this.drawPie(),this.draw3("init"),this.draw2("init"),this.drawBandWidth("init")},methods:{drawPie(){Object(r["a"])().then(t=>{if(t.hasOwnProperty("code")&&"ok"===t.code){var e=t.msg.gl_method,a=["GET","HEAD","POST","PUT","DELETE","CONNECT","OPTIONS","TRACE","PATCH","MOVE","COPY","LINK","UNLINK","WRAPPED","Extension-mothed"];for(var i in e){var s=parseInt(e[i]),r=String(i.split(" ")[0]);a.includes(r)?(this.gl_method_title.push(r),this.gl_method.push({name:r,value:s})):this.gl_method_title.includes("other")?this.gl_method.find(t=>{"other"===t.name&&(t.value=t.value+s)}):(this.gl_method_title.push("other"),this.gl_method.push({name:"other",value:s}))}let n=document.getElementById("reqPie"),o=d.a.init(n);this.option4.legend.data=this.gl_method_title,this.option4.series[0].data=this.gl_method,o.setOption(this.option4)}else this.$notify({type:"warning",title:"提示",message:t.msg,duration:1500,position:"bottom-right"})})},customRuleProcess(t){var e=new Array;for(var a in t)e.push({site:String(a.split(" ")[0]),total:parseInt(t[a])});return e},bandwidthProcess(t){var e=new Array,a=[];for(var i in t)e.push({site:String(i.split(" ")[0]),total:parseInt(t[i])/1024/1024}),a.push(String(i));return this.domainOptions=a,""===this.domainSelect&&(this.domainSelect=a[0]),e},async draw3(t){if(0==this.waf_start_day)var e=new Date((new Date).getTime()-6048e5),a=new Date;else e=new Date(this.waf_start_day),a=new Date(this.waf_end_day);var i=this.DateFormt(e,"yyyy-MM-dd"),s=this.DateFormt(a,"yyyy-MM-dd");if("init"==String(t)){var n,o={key:"request",stime:i,etime:s};n=await Object(r["c"])(o),this.waf_request=n.msg}var l={xData:[],waf_request:[]};switch(String(t)){case"1d":var h=this.X_list(e,a,"1d");for(var c in h){var u=0,p=h[c];for(var w in p){var _=p[w];u+=this.waf_request[_]||0}l["xData"].push(c),l["waf_request"].push(u)}break;case"1h":h=this.X_list(e,a,"1h");for(var c in h){u=0,p=h[c];for(var w in p){_=p[w];u+=this.waf_request[_]||0}l["xData"].push(c),l["waf_request"].push(u)}break;case"10m":h=this.X_list(e,a,"10m");for(var c in h){_=h[c],u=this.waf_request[_]||0;l["xData"].push(_),l["waf_request"].push(u)}break;default:h=this.X_list(e,a,"10m");for(var c in h){_=h[c],u=this.waf_request[_];l["xData"].push(_),l["waf_request"].push(u)}break}let y=document.getElementById("wafTrend"),m=d.a.init(y);this.option.xAxis.data=l["xData"],this.option.series[0].data=l["waf_request"],m.setOption(this.option)},initData(t,e,a,i){if(7==t)"draw3"===a?(this.waf_start_day=new Date((new Date).getTime()-6048e5),this.waf_end_day=new Date,this.draw3("init")):"draw2"===a?(this.waf_start_day2=new Date((new Date).getTime()-6048e5),this.waf_end_day2=new Date,this.draw2("init")):"drawBandWidth"===a&&(this.waf_start_day_bandwidth=new Date((new Date).getTime()-6048e5),this.waf_end_day_bandwidth=new Date,this.drawBandWidth("init"));else if(30==t)"draw3"===a?(this.waf_start_day=new Date((new Date).getTime()-2592e6),this.waf_end_day=new Date,this.draw3("init")):"draw2"===a?(this.waf_start_day2=new Date((new Date).getTime()-2592e6),this.waf_end_day2=new Date,this.draw2("init")):"drawBandWidth"===a&&(this.waf_start_day_bandwidth=new Date((new Date).getTime()-2592e6),this.waf_end_day_bandwidth=new Date,this.drawBandWidth("init"));else{var s,r,n=/^(\d{4})-(\d{2})-(\d{2})$/,d=i.date1,o=i.date2,l=(n.exec(d),!1);n.test(d)&&RegExp.$2<=12&&RegExp.$3<=31&&(s=new Date(d+" 00:00:00"),l=!0),n.test(d)&&RegExp.$2<=12&&RegExp.$3<=31&&(r=new Date(o+" 00:00:00"),l=!0),l||this.$notify({type:"warning",title:"提示",message:"请输入正确的时间格式",duration:1500,position:"bottom-right"}),console.log(r,s),r>s?"draw3"===a?(this.waf_start_day=s,this.waf_end_day=r,this.draw3("init")):"draw2"===a?(this.waf_start_day2=s,this.waf_end_day2=r,this.draw2("init")):"drawBandWidth"===a&&(this.waf_start_day_bandwidth=s,this.waf_end_day_bandwidth=r,this.drawBandWidth("init")):this.$notify({type:"warning",title:"提示",message:"结束时间小于开始时间",duration:1500,position:"bottom-right"})}},draw2(t){this.drawTrendChart(t,r["c"],{key:"host_Mod_name"},"dayTrend",this.site_request_Data,this.waf_start_day2,this.waf_end_day2)},drawBandWidth(t){console.log(this.domainSelect),console.log(this.domainSelect.slice(0,-10)),this.drawTrendChart(t,r["c"],{key:this.domainSelect},"bandWidthDayTrend",this.site_request_Data_BandWidth,this.waf_start_day_bandwidth,this.waf_end_day_bandwidth)},onDomainSelectChange(){this.drawBandWidth("init")},async drawTrendChart(t,e,a,i,s,n,o){if(0==n)var l=new Date((new Date).getTime()-6048e5),h=new Date;else l=new Date(n),h=new Date(o);var c=this.DateFormt(l,"yyyy-MM-dd"),u=this.DateFormt(h,"yyyy-MM-dd");if("init"==String(t)){var p,w=[];if("dayTrend"===i){var _=a;for(var y in p=await e(_),p.msg){var m,f={key:y,stime:c,etime:u};m=await e(f);var g={};g[y]=m.msg,w.push(g)}this.site_request_Data=[...w]}else if("bandWidthDayTrend"===i){var b,v=await Object(r["a"])();v.hasOwnProperty("code")&&"ok"===v.code?(this.customRule=this.customRuleProcess(v.msg.gl_host),this.pageTotal_customRule=this.customRule.length,this.results_customRule=this.customRule.slice(0,this.pageSize_customRule),this.bandwidthData=this.bandwidthProcess(v.msg.gl_host_byte),this.pageTotal_bandwidth=this.bandwidthData.length,this.results_bandwidth=this.bandwidthData.slice(0,this.pageSize_bandwidth)):this.$notify({type:"warning",title:"提示",message:v.msg,duration:1500,position:"bottom-right"});var S={key:this.domainSelect,stime:c,etime:u};b=await e(S);var D={};D[this.domainSelect]=b.msg,w.push(D),this.site_request_Data_BandWidth=[...w]}}var x=[],k=[],R=[];switch(String(t)){case"1d":var M=this.X_list(l,h,"1d");for(var T in s)for(var y in s[T]){var z=y.split(" ")[0],C=[],W=[];for(var O in M){var P=M[O];w=0;for(var B in P){g=P[B];w+=s[T][y][g]||0}C.push(O),W.push(w)}var q={name:z,type:"line",data:W};x.push(z),k=C,R.push(q)}break;case"1h":M=this.X_list(l,h,"1h");for(var T in s)for(var y in s[T]){z=y.split(" ")[0],C=[],W=[];for(var O in M){P=M[O],w=0;for(var B in P){g=P[B];w+=s[T][y][g]||0}C.push(O),W.push(w)}q={name:z,type:"line",data:W};x.push(z),k=C,R.push(q)}break;case"10m":M=this.X_list(l,h,"10m");for(var T in s)for(var y in s[T]){z=y.split(" ")[0],C=[],W=[];for(var O in M){g=M[O],w=s[T][y][g]||0;C.push(g),W.push(w)}q={name:z,type:"line",data:W};x.push(z),k=C,R.push(q)}break;default:M=this.X_list(l,h,"10m");var E=[];for(var T in"dayTrend"===i?E=this.site_request_Data:"bandWidthDayTrend"===i&&(E=this.site_request_Data_BandWidth),E)for(var y in E[T]){z=y.split(" ")[0],C=[],W=[];for(var O in M){g=M[O],w=E[T][y][g]||0;C.push(g),W.push(w)}q={name:z,type:"line",data:W};x.push(z),k=C,R.push(q)}break}let $=document.getElementById(i),A=d.a.init($);"dayTrend"===i?(this.option2.legend.data=x,this.option2.xAxis.data=k,this.option2.series=R,this.option2.title={text:""},A.setOption(this.option2)):"bandWidthDayTrend"===i&&(this.option2_bandwidth.legend.data=x,this.option2_bandwidth.xAxis.data=k,this.option2_bandwidth.series=R,this.option2_bandwidth.title={left:"left",text:"使用带宽(MB)"},A.setOption(this.option2_bandwidth))},handleSizeChange_customRule(t){this.currentPage_customRule=1,this.pageSize_customRule=t,this.results_customRule=this.customRule.slice(0,0+t)},handleCurrentChange_customRule(t){1===this.pageSize_customRule?this.results_customRule=this.customRule.slice(0,t*this.pageSize_customRule):this.results_customRule=this.customRule.slice(t*this.pageSize_customRule-this.pageSize_customRule,t*this.pageSize_customRule)},handleSizeChange_bandwidth(t){this.currentPage_bandwidth=1,this.pageSize_bandwidth=t,this.results_bandwidth=this.bandwidthData.slice(0,0+t)},handleCurrentChange_bandwidth(t){1===this.pageSize_bandwidth?this.results_bandwidth=this.bandwidthData.slice(0,t*this.pageSize_bandwidth):this.results_bandwidth=this.bandwidthData.slice(t*this.pageSize_bandwidth-this.pageSize_bandwidth,t*this.pageSize_bandwidth)}},components:{wafDivider:o,WafPage:l},watch:{$route(t,e){},ruleSearch:{handler:function(t,e){this.data=""===t?this.temp:this.data.filter((function(e){if(e.id.indexOf(t)>=0)return!0}))}}}},u=c,p=a("2877"),w=Object(p["a"])(u,i,s,!1,null,"1333507e",null);e["default"]=w.exports}}]);