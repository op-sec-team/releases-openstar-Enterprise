(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-334bd6c8"],{"1c31":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return l})),a.d(e,"b",(function(){return o}));var n=a("b775"),r=(a("4328"),a("365c"));function i(t){return Object(n["a"])({url:"".concat(r["a"].report.secGlobal),method:"get"})}function s(t){return Object(n["a"])({url:"".concat(r["a"].report.secTrendx),method:"get",params:t})}function l(t){return Object(n["a"])({url:"".concat(r["a"].report.secWafLog),method:"get",params:t})}function o(){return Object(n["a"])({url:"".concat(r["a"].report.secOwasp),method:"get"})}},a65c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"dashboard",staticStyle:{background:"#fff",padding:"0 50px"},attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"line-height":"50px","margin-top":"20px","padding-left":"10px"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},model:{value:t.searchContent,callback:function(e){t.searchContent=e},expression:"searchContent"}})],1)]),a("div",{staticStyle:{"line-height":"50px","margin-bottom":"20px","padding-left":"10px"}},[t._v(" 服务器选择： "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.onSelect},model:{value:t.host,callback:function(e){t.host=e},expression:"host"}},t._l(t.hostSelect,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("label",{staticStyle:{"margin-left":"20px"}},[t._v("日志条数")]),t._v(" "),a("el-input",{staticStyle:{width:"80px"},attrs:{placeholder:"最大值20000"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),a("span",{staticStyle:{"margin-left":"20px"},attrs:{required:!0}},[a("span",{staticStyle:{color:"red"}},[t._v("* ")]),t._v("最多查询20W条")]),t._v(" "),a("el-input",{staticStyle:{width:"180px","margin-left":"20px","margin-right":"20px"},attrs:{placeholder:"后端包含搜索"},model:{value:t.searchContentAsync,callback:function(e){t.searchContentAsync=e},expression:"searchContentAsync"}}),a("el-button",{attrs:{type:"primary"},on:{click:t.onSelect}},[t._v("查询")])],1),a("el-col",{staticStyle:{"margin-top":"-20px"},attrs:{span:24}},[a("el-table",{staticStyle:{},attrs:{data:t.results}},[a("el-table-column",{attrs:{label:"",prop:"content"}})],1)],1),a("el-col",{attrs:{span:24}},[a("WafPage",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{pageSizes:t.pageSizes,pageSize:t.pageSize,pageTotal:t.pageTotal,currentPage:t.currentPage},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}})],1)],1)],1)},r=[],i=(a("4de4"),a("c975"),a("fb6a"),a("b64b"),a("d3b7"),a("164e"),a("1c31"));function s(t){for(var e=[],a=0,n=t.length;a<n;a++){var r=t[a];-1===e.indexOf(r)&&e.push(r)}return e}function l(t){var e,a=[],n=[];t.sort();for(var r=0;r<t.length;r++)t[r]!==e?(a.push(t[r]),n.push(1)):n[n.length-1]++,e=t[r];return[a,n]}var o=function(){return a.e("chunk-3095c0ef").then(a.bind(null,"8af7"))},c=function(){return a.e("chunk-2d22c16d").then(a.bind(null,"f26a"))},h={data:function(){return{num:100,wafLogResult:[],wafDenyCount:"",wafAttackIP:"",wafAttackIPCount:"",gl_method:[],gl_method_title:[],option:{title:{text:"web攻击类型统计",x:"left"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"right",data:[]},series:[{name:"攻击类型",type:"pie",radius:"80%",center:["50%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},results:[],pageTable:[],pageSizes:[50],pageSize:50,pageTotal:0,currentPage:1,hostArr:[],hostObj:{},host:"",hostSelect:[],searchType:"url",content_select:[{label:"攻击类型",value:"attack_type"},{label:"攻击IP",value:"attack_ip"},{label:"攻击时间",value:"attack_time"},{label:"防护主机",value:"host"},{label:"协议类型",value:"scheme"},{label:"请求方法",value:"method"},{label:"攻击者浏览器",value:"user_agent"},{label:"访问URL",value:"url"},{label:"拦截位置",value:"position"},{label:"拦截设置",value:"deny_func"}],searchContent:"",tempContent:[],searchContentAsync:""}},mounted:function(){this.drawPie(this.host)},methods:{handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.results=this.pageTable.slice(0,0+t)},handleCurrentChange:function(t){1===this.pageSize?this.results=this.pageTable.slice(0,t*this.pageSize):this.results=this.pageTable.slice(t*this.pageSize-this.pageSize,t*this.pageSize)},onSelect:function(){this.drawPie(this.host)},drawPie:function(t){var e=this,a={num:this.num,format:!0,key:this.searchContentAsync};Object(i["d"])(a).then((function(a){if(a.hasOwnProperty("code")&&"ok"===a.code){var n={},r=Object.keys(a.msg),i=[];for(var s in r)if(Object.keys(a.msg[r[s]].re).length>0){n[r[s]]=a.msg[r[s]].re.reverse();var l={};l["label"]=r[s],l["value"]=r[s],i.push(l)}e.hostArr=r,e.hostObj=n,e.host=r[0],e.hostSelect=i;var o=Object.keys(n)[0];""==t?e.initData(o):e.initData(t)}else e.$notify({type:"warning",title:"提示",message:l.msg,duration:1500,position:"bottom-right"})}))},initData:function(t){var e=[],a=[],n=[];e=this.hostObj[t],this.pageTable=e,this.pageTotal=e.length,this.results=e.slice(0,this.pageSize),this.tempContent=e,this.wafDenyCount=this.hostObj[t].length,this.wafAttackIP=s(a),this.wafAttackIPCount=s(a).length;var r=l(n);for(var i in this.gl_method_title=[],this.gl_method=[],r[0]){var o=String(r[0][i]),c=parseInt(r[1][i]);this.gl_method_title.push(o),this.gl_method.push({name:o,value:c})}},onSearch:function(){}},components:{wafCard:o,WafPage:c},watch:{$route:function(t,e){},searchContent:{handler:function(t,e){""!==this.searchType&&(""===t?this.results=this.tempContent:(this.results=this.tempContent.filter((function(e){if(e.content[0].indexOf(t)>=0)return!0})),this.pageTotal=this.results.length))}}}},u=h,p=(a("ca71"),a("2877")),d=Object(p["a"])(u,n,r,!1,null,"2367f6e9",null);e["default"]=d.exports},a880:function(t,e,a){},ca71:function(t,e,a){"use strict";a("a880")},fb6a:function(t,e,a){"use strict";var n=a("23e7"),r=a("861d"),i=a("e8b5"),s=a("23cb"),l=a("50c4"),o=a("fc6a"),c=a("8418"),h=a("b622"),u=a("1dde"),p=a("ae40"),d=u("slice"),g=p("slice",{ACCESSORS:!0,0:0,1:2}),f=h("species"),b=[].slice,m=Math.max;n({target:"Array",proto:!0,forced:!d||!g},{slice:function(t,e){var a,n,h,u=o(this),p=l(u.length),d=s(t,p),g=s(void 0===e?p:e,p);if(i(u)&&(a=u.constructor,"function"!=typeof a||a!==Array&&!i(a.prototype)?r(a)&&(a=a[f],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return b.call(u,d,g);for(n=new(void 0===a?Array:a)(m(g-d,0)),h=0;d<g;d++,h++)d in u&&c(n,h,u[d]);return n.length=h,n}})}}]);