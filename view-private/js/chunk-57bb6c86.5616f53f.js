(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57bb6c86"],{"1fbe":function(t,e,r){"use strict";r.d(e,"e",(function(){return s})),r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return c})),r.d(e,"h",(function(){return m})),r.d(e,"d",(function(){return p})),r.d(e,"g",(function(){return u})),r.d(e,"c",(function(){return f})),r.d(e,"f",(function(){return d}));var i=r("b775"),n=r("4328"),o=r.n(n),a=r("365c");function s(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.getStream),method:"get",params:t})}function l(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.addStream),method:"post",data:o.a.stringify(t)})}function c(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.delStream),method:"post",data:o.a.stringify(t)})}function m(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.setStream),method:"post",data:o.a.stringify(t)})}function p(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.getSip),method:"get",params:t})}function u(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.setSip),method:"post",data:o.a.stringify(t)})}function f(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.configDict),method:"get",params:t})}function d(t){return Object(i["a"])({url:"".concat(a["a"].fourtier.configDict),method:"post",data:o.a.stringify(t)})}},"53f6":function(t,e,r){},"92aa":function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-card",{attrs:{shadow:"never"}},[r("el-row",{staticStyle:{"margin-bottom":"10px","margin-left":"10px","margin-right":"10px"},attrs:{gutter:10}},[r("div",{staticStyle:{width:"300px",float:"left"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),r("div",{staticStyle:{float:"right"}},[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("添加")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleSave}},[t._v("保存")])],1)]),r("el-table",{attrs:{data:t.streamList,border:""}},[r("el-table-column",{attrs:{label:"stream名称",align:"center",prop:"stream_name","min-width":"12%","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"描述",align:"left",prop:"des","min-width":"15%","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"diff_file",align:"left",prop:"diff_file","min-width":"8%","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"内容",align:"left",prop:"contents","min-width":"53%","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"12%","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{staticStyle:{color:"rgba(24, 144, 255, 1)"},attrs:{type:"text"},on:{click:function(r){return t.handleSet(e.row)}}},[t._v("编辑")]),r("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.row.visible,callback:function(r){t.$set(e.row,"visible",r)},expression:"scope.row.visible"}},[r("p",[t._v("确定要删除吗?")]),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.row.visible=!1}}},[t._v("取消")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return t.handleDel(e.row)}}},[t._v("确定")])],1),r("el-button",{staticStyle:{color:"rgba(212, 48, 48, 1)","margin-left":"10px"},attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),r("el-dialog",{attrs:{title:t.title,visible:t.open,width:"60%"},on:{"update:visible":function(e){t.open=e}}},[r("el-tabs",{on:{"tab-click":this.tabClick},model:{value:t.activename,callback:function(e){t.activename=e},expression:"activename"}},[r("el-tab-pane",{attrs:{label:"基础",name:"基础"}},[r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"190px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"stream名称:",prop:"stream_name"}},[r("el-input",{model:{value:t.form.stream_name,callback:function(e){t.$set(t.form,"stream_name",e)},expression:"form.stream_name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticClass:"change-label-width",attrs:{label:"描述:",prop:"des"}},[r("el-input",{model:{value:t.form.des,callback:function(e){t.$set(t.form,"des",e)},expression:"form.des"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"端口:",prop:"port"}},[r("el-input",{model:{value:t.form.port,callback:function(e){t.$set(t.form,"port",t._n(e))},expression:"form.port"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticClass:"change-label-width",attrs:{label:"协议:",prop:"l_type"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"协议"},model:{value:t.form.l_type,callback:function(e){t.$set(t.form,"l_type",e)},expression:"form.l_type"}},t._l(t.agreeArray,(function(t){return r("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1)],1)],1)],1),r("el-form-item",{attrs:{label:"proxy_connect_timeout:",prop:"proxy_connect_timeout"}},[r("el-col",[r("el-input",{staticStyle:{width:"38%","margin-right":"5px"},model:{value:t.form.proxy_connect_timeout,callback:function(e){t.$set(t.form,"proxy_connect_timeout",e)},expression:"form.proxy_connect_timeout"}}),r("span",{staticStyle:{color:"red","margin-left":"20px"}},[t._v("* ")]),t._v("eg:5s 单位：秒 ")],1)],1),r("el-form-item",{attrs:{label:"proxy_timeout:",prop:"proxy_timeout"}},[r("el-col",[r("el-input",{staticStyle:{width:"38%","margin-right":"5px"},model:{value:t.form.proxy_timeout,callback:function(e){t.$set(t.form,"proxy_timeout",e)},expression:"form.proxy_timeout"}}),r("span",{staticStyle:{color:"red","margin-left":"20px"}},[t._v("* ")]),t._v("eg:30s 单位：秒 ")],1)],1),r("el-form-item",{attrs:{label:"源站:",prop:"ips"}},[r("el-col",[r("el-input",{attrs:{type:"textarea",rows:"6"},model:{value:t.form.ips,callback:function(e){t.$set(t.form,"ips",e)},expression:"form.ips"}}),r("span",{staticStyle:{color:"red","margin-left":"20px"}},[t._v("* ")]),t._v('eg: [{"fail_timeout":"10s","server":"192.168.28.26:1188","weight":2}...] ')],1)],1)],1)],1),"编辑"===t.title?r("el-tab-pane",{attrs:{label:"高级",name:"高级"}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:24}},[r("codemirror",{ref:"codemirrorRef",staticClass:"editorR",attrs:{options:t.options},model:{value:t.form.ngx_file,callback:function(e){t.$set(t.form,"ngx_file",e)},expression:"form.ngx_file"}})],1)],1)],1):t._e()],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),r("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)],1)},n=[],o=(r("4de4"),r("c975"),r("b0c0"),r("5530")),a=r("8f94"),s=(r("a7be"),r("acdf"),r("7ba3"),r("a8d9"),r("db91"),r("b2b9"),r("f9d4"),r("8e77")),l=r("45a3"),c=r("1fbe"),m=r("a417"),p=r("e762").Base64,u={components:{MarkdownPreview:s["a"],vueJsonEditor:l["a"],codemirror:a["codemirror"]},data:function(){return{code:'[{\n    "port": 1188,\n    "stream_name": "stream名称（唯一）[stream_1188]",\n    "l_type": "nil/udp/tcp",\n    "des": "描述 stream 1188 for grpc",\n    "proxy_connect_timeout": "5s",\n    "proxy_timeout": "30s",\n    "ips": [\n        {\n            "server": "192.168.28.26:1188",\n            "weight": 2,\n            "fail_timeout": "10s"\n        },\n        {\n            "server": "192.168.28.27:1188",\n            "max_fails": 3\n        },\n        {\n            "server": "192.168.28.28:1188",\n            "max_fails": 5,\n            "fail_timeout": "10s"\n        }\n    ]\n},\n...\n]',options:{tabSize:4,mode:{name:"javascript",json:!0},theme:"darcula",lineNumbers:!0,line:!0,lineWrapping:!0,styleSelectedText:!0,styleActiveLine:!0,hintOptions:{completeSingle:!0}},streamList:[],tempList:[],search:"",activename:"基础",open:!1,title:"",certs_key:[],form:{stream_name:"stream",des:"des",port:8080,l_type:"tcp",proxy_connect_timeout:"",proxy_timeout:"",ips:"",ngx_file:""},rules:{stream_name:[{required:!0,message:"stream名称不能为空",trigger:"blur"}],port:[{required:!0,message:"端口不能为空",trigger:"blur"},{type:"number",message:"端口必须为数字"}],proxy_connect_timeout:[{required:!0,message:"proxy_connect_timeout不能为空",trigger:"blur"}],proxy_timeout:[{required:!0,message:"proxy_timeout不能为空",trigger:"blur"}],ips:[{required:!0,message:"源站不能为空",trigger:"blur"}]},agreeArray:[{value:"tcp"},{value:"udp"}]}},created:function(){this.getList()},methods:{tabClick:function(t,e){"高级"===t.name&&this.$refs.codemirrorRef.refresh()},getList:function(){var t=this,e={stream_name:"all_stream"};Object(c["e"])(e).then((function(e){console.log(e);var r=e.msg,i=[];for(var n in r)i.push(Object(o["a"])(Object(o["a"])({},r[n]),{},{contents:JSON.stringify(r[n]),ips:JSON.stringify(r[n].ips)}));t.streamList=i,t.tempList=i}))},reset:function(){this.form={stream_name:"",des:"",port:0,l_type:"tcp",proxy_connect_timeout:"",proxy_timeout:"",ips:"",ngx_file:""}},cancel:function(){this.open=!1,this.reset()},checkisRewrite_https:function(){this.form.http.isRewrite_https&&(this.form.isOpenHttps=!0)},handleAdd:function(){this.reset(),this.title="添加",this.activename="基础",this.open=!0},handleSet:function(t){this.reset(),this.title="编辑",this.activename="基础",this.form=t,this.open=!0},handleDel:function(t){var e=this,r=[t.stream_name],i={stream_names:JSON.stringify(r)};Object(c["b"])(i).then((function(t){"ok"===t.code?(e.$notify({title:"成功",message:t.msg,type:"success"}),e.open=!1,e.getList()):e.$notify({title:"警告",message:t.msg,type:"warning"})}))},submitForm:function(){var t=this;this.$refs["form"].validate((function(t){}));var e=this.form,r=e.stream_name,i=e.des,n=e.port,a=e.l_type,s=e.proxy_connect_timeout,l=e.proxy_timeout,m={stream_name:r,des:i,port:n,l_type:a,proxy_connect_timeout:s,proxy_timeout:l,ips:JSON.parse(this.form.ips)};if("编辑"===this.title)if("基础"===this.activename){var p={value:JSON.stringify([Object(o["a"])({},m)])};Object(c["h"])(p).then((function(e){"ok"===e.code?(t.$notify({title:"成功",message:e.msg,type:"success"}),t.open=!1,t.getList(1)):t.$notify({title:"警告",message:e.msg,type:"warning"})}))}else{var u={value:JSON.stringify([Object(o["a"])(Object(o["a"])({},m),{},{ngx_file:this.form.ngx_file})])};Object(c["h"])(u).then((function(e){"ok"===e.code?(t.$notify({title:"成功",message:e.msg,type:"success"}),t.open=!1,t.getList(1)):t.$notify({title:"警告",message:e.msg,type:"warning"})}))}else{var f={value:JSON.stringify([Object(o["a"])({},m)])};Object(c["a"])(f).then((function(e){"ok"===e.code?(t.$notify({title:"成功",message:e.msg,type:"success"}),t.open=!1,t.getList(1)):t.$notify({title:"警告",message:e.msg,type:"warning"})}))}},handleSave:function(){var t=this,e={action:"save",mod:"all_Mod"};Object(m["h"])(e).then((function(e){"ok"==e.code?t.$notify({title:"成功",message:e.msg,type:"success"}):t.$notify({title:"警告",message:e.msg,type:"warning"})}))}},filters:{match:function(t){return p.decode(t)}},watch:{$route:function(t,e){},search:{handler:function(t,e){this.streamList=""===t?this.tempList:this.tempList.filter((function(e){if(e.contents.indexOf(t)>=0)return!0}))}}}},f=u,d=(r("fe20"),r("2877")),g=Object(d["a"])(f,i,n,!1,null,"d9a4c234",null);e["default"]=g.exports},fe20:function(t,e,r){"use strict";r("53f6")}}]);